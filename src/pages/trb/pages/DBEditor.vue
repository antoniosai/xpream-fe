<style scoped>
::v-deep .label.is-success {
    background-color: #20bc71;
    color: white;
}

::v-deep .panel-heading{
    background: #F3F7FB !important;
}

::v-deep .btn-default{
    height: 32px !important; 
    line-height: 28px !important; 
    color: rgb(70, 83, 104) !important; 
    background-color: #fff !important;  
    border: 1px solid #e5e5e5 !important;
    font-size: 9pt !important;
}

::v-deep .btn-default:hover {
    background-color: rgba(225, 228, 238, 0.5) !important;
}

::v-deep .revision-name {
    cursor: pointer;
}

::v-deep .revision-name:hover {
    color: #0065FF;
}

::v-deep .is-table-fixed table thead tr{
    display:block;
}

::v-deep .is-table-fixed-core table {
    width: 528px !important;
}

::v-deep .is-table-fixed-core table th, .is-table-fixed-core table td{
    width:80px !important;
}

::v-deep .is-table-fixed-core table th:nth-child(1), .is-table-fixed-core table td:nth-child(1){
    width: 262px !important;
    text-align: left !important;
}

::v-deep .is-table-fixed-core table th:nth-child(4), .is-table-fixed-core table td:nth-child(4){
    width:80px !important;
}


/* Table Detail Task Preparation */

::v-deep .is-table-fixed-prep table {
    width: 528px !important;
}

::v-deep .is-table-fixed-prep table th:nth-child(1), .is-table-fixed-prep table td:nth-child(1){
    width: 342px !important;
}

::v-deep .is-table-fixed-prep table th:nth-child(2), .is-table-fixed-prep table td:nth-child(2){
    width: 80px !important;
}

::v-deep .is-table-fixed-prep table th:nth-child(3), .is-table-fixed-prep table td:nth-child(3){
    width: 80px !important;
}


::v-deep .is-table-fixed-material table {
    width: 528px !important;
}

::v-deep .is-table-fixed-material table th:nth-child(1), .is-table-fixed-material table td:nth-child(1){
    width: 342px !important;
}

::v-deep .is-table-fixed-material table th:nth-child(2), .is-table-fixed-material table td:nth-child(2){
    width: 80px !important;
}

::v-deep .is-table-fixed-material table th:nth-child(3), .is-table-fixed-material table td:nth-child(3){
    width: 80px !important;
}

/* ::v-deep .is-table-fixed-access table th, .is-table-fixed-access table td{
    width: 137px !important;
} */

::v-deep .is-table-fixed-material-prep table {
    width: 527px !important;
}

::v-deep .is-table-fixed-material-prep table th:nth-child(1), .is-table-fixed-material-prep table td:nth-child(1){
    width: 200px !important;
}

::v-deep .is-table-fixed-material-prep table th:nth-child(2), .is-table-fixed-material-prep table td:nth-child(2){
    width: 150px !important;
}

::v-deep .is-table-fixed-material-prep table th:nth-child(3), .is-table-fixed-material-prep table td:nth-child(3){
    width: 70px !important;
}

::v-deep .is-table-fixed-material-prep table th:nth-child(4), .is-table-fixed-material-prep table td:nth-child(4){
    width: 80px !important;
}






::v-deep .is-table-fixed-access table {
    width: 542px !important;
}

::v-deep .is-table-fixed-access table th:nth-child(1), .is-table-fixed-access table td:nth-child(1){
    width: 80px !important;
}

::v-deep .is-table-fixed-access table th:nth-child(2), .is-table-fixed-access table td:nth-child(2){
    width: 88px !important;
}

::v-deep .is-table-fixed-access table th:nth-child(3), .is-table-fixed-access table td:nth-child(3){
    width: 66px !important;
}

::v-deep .is-table-fixed-access table th:nth-child(4), .is-table-fixed-access table td:nth-child(4){
    width: 66px !important;
}

::v-deep .is-table-fixed-access table th:nth-child(5), .is-table-fixed-access table td:nth-child(5){
    width: 66px !important;
}

::v-deep .is-table-fixed-access table th:nth-child(6), .is-table-fixed-access table td:nth-child(6){
    width: 66px !important;
}

::v-deep .is-table-fixed-access table th:nth-child(7), .is-table-fixed-access table td:nth-child(7){
    width: 80px !important;
}



::v-deep .is-table-fixed-ref table {
    width: 840px !important;
}

::v-deep .is-table-fixed-ref table th:nth-child(1), .is-table-fixed-ref table td:nth-child(1){
    width: 170px !important;
}

::v-deep .is-table-fixed-ref table th:nth-child(2), .is-table-fixed-ref table td:nth-child(2){
    width: 423px !important;
}

::v-deep .is-table-fixed-ref table th:nth-child(3), .is-table-fixed-ref table td:nth-child(3){
    width: 70px !important;
}

::v-deep .is-table-fixed-ref table th:nth-child(4), .is-table-fixed-ref table td:nth-child(4){
    width: 70px !important;
}

::v-deep .is-table-fixed-ref table th:nth-child(5), .is-table-fixed-ref table td:nth-child(5){
    width: 80px !important;
}

::v-deep .is-table-fixed-core-material table {
    width: 840px !important;
}

::v-deep .is-table-fixed-core-material table th:nth-child(1), .is-table-fixed-core-material table td:nth-child(1){
    width: 310px !important;
}

::v-deep .is-table-fixed-core-material table th:nth-child(2), .is-table-fixed-core-material table td:nth-child(2){
    width: 294px !important;
}

::v-deep .is-table-fixed-core-material table th:nth-child(3), .is-table-fixed-core-material table td:nth-child(3){
    width: 130px !important;
}

::v-deep .is-table-fixed-core-material table th:nth-child(4), .is-table-fixed-core-material table td:nth-child(4){
    width: 80px !important;
}


::v-deep .is-table-fixed table  tbody{
  display:block;
  height:243px !important;
  overflow:auto;
}

::v-deep .modal-editor {
    padding: 15px 15px 0px 15px !important;
}

::v-deep .btn-add-row {
    height: 30px !important;
    width: 30px !important;
    padding: 0px 0px 0px 7px !important;
    margin-left: -50px !important;
}

::v-deep .is-table-fixed-add table thead tr{
    display:block;
}

::v-deep .is-table-fixed-add table  tbody{
  display:block;
  height:240px;
  overflow:auto;
  position: relative;
}

::v-deep .is-table-fixed-add-part-panel table thead tr{
    display:block;
}

::v-deep .is-table-fixed-add-part-panel table  tbody{
  display:block;
  height:200px;
  overflow:auto;
  position: relative;
}

::v-deep .is-table-fixed-add-zone table {
    width: 608px !important;
}

::v-deep .is-table-fixed-add-zone th, .is-table-fixed-add-zone table td{
    width: 170px !important;
}

::v-deep .is-table-fixed-add-zone th:nth-child(2), .is-table-fixed-add-zone table td:nth-child(2),
.is-table-fixed-add-zone th:nth-child(3), .is-table-fixed-add-zone table td:nth-child(3){
    text-align: center;
}

::v-deep .is-table-fixed-add-zone th:last-child, .is-table-fixed-add-zone table td:last-child {
    width: 70px !important;
}

/* style add access */
::v-deep .is-table-fixed-add-access table {
    width: 616px !important;
}

::v-deep .is-table-fixed-add-access th, .is-table-fixed-add-access table td{
    width: 76px !important;
    text-align: center;
}

::v-deep .is-table-fixed-add-access th:nth-child(1), .is-table-fixed-add-access table td:nth-child(1){
    width: 94px !important;
    text-align: center;
}

::v-deep .is-table-fixed-add-access th:nth-child(2), .is-table-fixed-add-access table td:nth-child(2){
    width: 120px !important;
    text-align: center;
}

::v-deep .is-table-fixed-add-access th:nth-child(7), .is-table-fixed-add-access table td:nth-child(7){
    width: 60px !important;
    text-align: center;
}

::v-deep .is-table-fixed-add-access th:nth-child(3), .is-table-fixed-add-access table td:nth-child(3),
.is-table-fixed-add-access th:nth-child(4), .is-table-fixed-add-access table td:nth-child(4){
    text-align: center;
}


::v-deep .is-table-fixed-add-access th:last-child, .is-table-fixed-add-access table td:last-child {
    width: 70px !important;
}

/* style add prep */
::v-deep .is-table-fixed-add-prep table {
    width: 608px !important;
}

::v-deep .is-table-fixed-add-prep th, .is-table-fixed-add-prep table td{
    width: 431px !important;
}


::v-deep .is-table-fixed-add-prep th:last-child, .is-table-fixed-add-prep table td:last-child {
    width: 70px !important;
}


::v-deep .is-table-fixed-add-prep th:nth-child(2), .is-table-fixed-add-prep table td:nth-child(2){
    width: 80px !important;
    text-align: center;
}

/* style add ref */
::v-deep .is-table-fixed-add-ref table {
    width: 623px !important;
}

/* ::v-deep .is-table-fixed-add-ref th, .is-table-fixed-add-ref table td{
    width: 336px !important;
}

::v-deep .is-table-fixed-add-ref th:last-child, .is-table-fixed-add-ref table td:last-child {
    width: 70px !important;
} */

::v-deep .is-table-fixed-add-ref th:nth-child(1), .is-table-fixed-add-ref table td:nth-child(1){
    width: 190px !important;
    text-align: center;
}

::v-deep .is-table-fixed-add-ref th:nth-child(2), .is-table-fixed-add-ref table td:nth-child(2){
    width: 190px !important;
    text-align: center;
}

::v-deep .is-table-fixed-add-ref th:nth-child(3), .is-table-fixed-add-ref table td:nth-child(3){
    width: 70px !important;
    text-align: center;
}

::v-deep .is-table-fixed-add-ref th:nth-child(4), .is-table-fixed-add-ref table td:nth-child(4){
    width: 70px !important;
    text-align: center;
}

::v-deep .is-table-fixed-add-ref th:nth-child(5), .is-table-fixed-add-ref table td:nth-child(5){
    width: 75px !important;
    text-align: center;
}

/* style add part */

::v-deep .is-table-fixed-add-part table {
    width: 510px !important;
}
::v-deep .is-table-fixed-add-part th, .is-table-fixed-add-part table td{
    width: 200px !important;
}

::v-deep .is-table-fixed-add-part th:last-child, .is-table-fixed-add-part table td:last-child {
    width: 70px !important;
}

::v-deep .is-table-fixed-add-part th:nth-child(2), .is-table-fixed-add-part table td:nth-child(2){
    width: 145px !important;
}

::v-deep .is-table-fixed-add-part th:nth-child(3), .is-table-fixed-add-part table td:nth-child(3){
    width: 66px !important;
    text-align: center;
}

/* style add prep part */

::v-deep .is-table-fixed-add-preppart table {
    width: 760px !important;
}

::v-deep .is-table-fixed-add-preppart th, .is-table-fixed-add-preppart table td{
    width: 250px !important;
}

::v-deep .is-table-fixed-add-preppart th:last-child, .is-table-fixed-add-preppart table td:last-child {
    width: 70px !important;
}

::v-deep .is-table-fixed-add-preppart th:nth-child(2), .is-table-fixed-add-preppart table td:nth-child(2){
    width: 200px !important;
}

::v-deep .is-table-fixed-add-preppart th:nth-child(3), .is-table-fixed-add-preppart table td:nth-child(3){
    width: 145px !important;
}

::v-deep .is-table-fixed-add-preppart th:nth-child(4), .is-table-fixed-add-preppart table td:nth-child(4){
    width: 66px !important;
    text-align: center;
}

/* style add ref part */

::v-deep .is-table-fixed-add-refpart table {
    width: 690px !important;
}

::v-deep .is-table-fixed-add-refpart th, .is-table-fixed-add-refpart table td{
    width: 250px !important;
}

::v-deep .is-table-fixed-add-refpart th:last-child, .is-table-fixed-add-refpart table td:last-child {
    width: 70px !important;
}

::v-deep .is-table-fixed-add-refpart th:nth-child(2), .is-table-fixed-add-refpart table td:nth-child(2){
    width: 200px !important;
}

::v-deep .is-table-fixed-add-refpart th:nth-child(3), .is-table-fixed-add-refpart table td:nth-child(3){
    width: 145px !important;
}

::v-deep .is-table-fixed-add-refpart th:nth-child(4), .is-table-fixed-add-refpart table td:nth-child(4){
    width: 66px !important;
    text-align: center;
}

::v-deep  .vgt-left-align {
    white-space: nowrap !important;
}

::v-deep .table.vgt-table{
    font-size: 9px !important; 
    border-collapse: collapse !important;
    background-color: #fff !important;
    width: 100% !important;
    max-width: 100% !important;
    table-layout: auto !important;
    border: 1px solid #dcdfe6 !important;
}

::v-deep .vgt-table.bordered td, .vgt-table.bordered th {
    border: 1px solid #dcdfe6  !important;
    height: 20px  !important;
    font-size: 9pt  !important;
}

::v-deep .vgt-wrap__footer {
    font-size: 9pt !important;
    /* color: #606266; */
    padding: 0.5em !important;
    height: 35px !important;
    border: 1px solid #dcdfe6 !important;
    background: #ffffff !important;
}


::v-deep .vgt-wrap__footer .footer__row-count__label {
    font-size: 9pt !important;
    color: #909399 !important;
}

::v-deep .vgt-wrap__footer .footer__navigation__page-btn.disabled, .vgt-wrap__footer .footer__navigation__page-btn.disabled:hover {
    opacity: .5 !important;
    cursor: not-allowed !important;
    box-shadow: 0 0 black !important;
    font-size: 9pt !important;
}

::v-deep .vgt-wrap__footer .footer__navigation__info, .vgt-wrap__footer .footer__navigation__page-info {
    display: inline-block !important;
    color: #909399 !important;
    margin: 0 16px !important;
    font-size: 9pt !important;
}

::v-deep .vgt-wrap__footer .footer__navigation__page-btn {
    text-decoration: none !important;
    color: #606266 !important;
    font-weight: 700 !important;
    white-space: nowrap !important;
    font-size: 9pt !important;
}

::v-deep .vgt-global-search__input .input__icon .magnifying-glass {
    margin-top: 8px !important;
    margin-left: 10px !important;
    display: block !important;
    width: 12px !important;
    height: 12px !important;
    border: 2px solid #d6dae2 !important;
    position: relative !important;
    border-radius: 50% !important;
}

::v-deep .vgt-input, .vgt-select{
    font-size: 9pt !important;
}

::v-deep .footer__row-count__label {
    margin-top: -7px !important;
}

::v-deep .footer__navigation{
    margin-top: -2px !important;
}

::v-deep .vgt-wrap__footer .footer__row-count__select {
    margin-top: -5px !important;
    width: 50px !important;
    padding: 0px 15px 0px 5px;
    border: 0px  !important;
    border-radius: 0px !important;
    color: #606266 !important;
    font-weight: 700 !important;
    font-size: 9pt !important;
    margin-left: 0px !important;
    height: 32px !important;
    line-height: 32px !important;
}

::v-deep .vgt-wrap__footer .footer__navigation__page-info__current-entry {
     width: 50px !important;
    text-align: center !important;
    display: inline-block !important;
    margin: 0 10px !important;
    font-weight: 700 !important;
    height: 25px !important;
}

::v-deep .vgt-global-search {
    background: #ffffff !important;
    border: 1px solid #dcdfe6  !important;
}

::v-deep .vgt-table thead th {
    background: #ffffff !important;
}

::v-deep input[type=file] {
    line-height: 0px !important;
}

</style>


<template>
    <div>
        <div class="card-header">
            <div class="title-area">
                <h3 class="title">Database Editor</h3>
            </div>
            <div class="option-box">
                <div class="option-item">
                    <span style="white-space: nowrap">Aircraft Type</span>
                    <select id="aircraft-type" v-model="form.id_aircraft">
                        <option value="" disabled selected>A/C Type</option>
                        <option v-for="aircraft in aircrafts" :key="aircraft.ID" v-bind:value="aircraft.ID">{{ aircraft.AIRCRAFT }}</option>
                    </select>
                </div>
                <div class="option-item">
                    <button v-on:click="findRevision()">
                        <i class="material-icons">search</i>
                        Search
                    </button>
                </div>
            </div>
        </div>
        <div class="card-content">   
            <loading style="margin-top: 50px;"
                :active.sync="loading.isLoading" 
                :can-cancel="false"
                :is-full-page="false"
                :color="loading.color"
                :loader="loading.loaderType">
            </loading>

            <!-- Data revision -->
            <div v-if="isRevisionShow">
                <div style="padding-bottom: 10px;">
                    <button class="button" v-on:click="handlerModalAddRevision()">
                        <i class='material-icons'>
                            add
                        </i>
                        Revision
                    </button>
                    <button class="button is-success" v-on:click="handlerModalMasterData()">
                        <i class="material-icons">folder</i>
                        Master Data
                    </button>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <div style="padding: 5px 0px 5px 0px;">
                            Revision Lists
                        </div>
                    </div>
                    <div style=""  class="panel-body">
                        <div v-if="revisions.length < 1">
                            No data revision available. 
                        </div>
                        <div v-else>
                            <div v-for="(revision, index) in revisions" :key="revision.ID">
                                <div class="is-row">
                                    <div class="is-col is-60">
                                        <div>
                                            <span class="revision-name" style="font-size: 10pt;"><b>{{revision.NAME}}</b> </span>
                                            <span v-if="revision.STATUS == 'active'" style="font-size: 9pt;" class="label is-success">{{revision.STATUS}}</span>
                                            <span v-else style="font-size: 9pt;" class="label is-danger">{{revision.STATUS}}</span>
                                        </div>
                                        <div>
                                            <span style="font-size: 9pt;">v{{revision.VERSION}} . {{revision.CREATED_AT.substring(0, 19)}} . {{revision.DESCRIPTION}}</span>
                                        </div>
                                    </div>
                                    <div class="is-col is-40" style="text-align: right">
                                        <div style="margin-top: 7px;">
                                            <button v-on:click="handlerActivateRevision(revision.ID, revision.ID_AIRCRAFT)" v-if="revision.STATUS !== 'active'" class="btn-default">
                                                <i style="font-size: 10pt;" class='material-icons'>
                                                    swap_vertical_circle
                                                </i>
                                                Active
                                            </button>
                                            <button v-on:click="handlerExportRevision(revision.ID, revision.ID_AIRCRAFT, `MPD_${revision.AIRCRAFT}_R${revision.VERSION}`)" class="btn-default">
                                                <i class='material-icons'>
                                                    file_download
                                                </i>
                                                Clone
                                            </button>
                                            <button v-on:click="handlerShowDetailRevision(revision.ID, revision.ID_AIRCRAFT)" class="btn-default">
                                                <i class='material-icons'>
                                                    visibility
                                                </i>
                                                View Details
                                            </button>

                                            <button v-if="revision.STATUS == 'active'" disabled style="width: 32px; height: 32px; padding-right: 10px; padding-left: 17px;" class="button is-danger is-small">
                                                <i style="font-size: 12pt;" class='material-icons'>
                                                    delete
                                                </i>
                                            </button>

                                            <button v-on:click="handlerDeleteRevision(revision.ID, revision.ID_AIRCRAFT)" v-else style="width: 32px; height: 32px; padding-right: 10px; padding-left: 17px;" class="button is-danger is-small">
                                                <i style="font-size: 12pt;" class='material-icons'>
                                                    delete
                                                </i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <hr v-if="index != Object.keys(revisions).length - 1">
                            </div>
                        </div>

                    </div>
                </div>

            </div>
            <div v-else class="card-content">
                <span style="font-size: 9pt;">{{message}}</span>
            </div>

            <!-- Detail revision -->
            <div v-if="isDetailRevisionShow">
                <div style="padding-bottom: 10px;">
                    <button v-on:click="handlerShowRevision()">
                        <i class='material-icons'>
                            arrow_back
                        </i>
                        Back
                    </button>
                    <button class="button is-success" v-on:click="handlerShowAddMPD()">
                        <i class='material-icons'>
                            add
                        </i>
                        Add New
                    </button>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <div style="padding: 5px 0px 5px 0px;">
                            <div class="title-area">
                                Detail revision
                            </div>
                        </div>
                    </div>
                    <div style=""  class="panel-body">
                         <div  style="box-sizing: border-box; position: relative; min-height: 20px;">
                            <div>
                                <loading style="margin-top: 50px;"
                                    :active.sync="loading.isDetailLoading" 
                                    :can-cancel="false"
                                    :is-full-page="false"
                                    :color="loading.color"
                                    :loader="loading.loaderType">
                                </loading>
                            </div>
                            <template>
                                <div class="feedback">
                                    <vue-good-table
                                        ref="tableDetailRevision"
                                        :columns="detail_revision.fields"
                                        :rows="detail_revision.rows"  
                                        styleClass="vgt-table bordered striped"
                                        mode="remote"
                                        max-height="510px"
                                        :search-options="{
                                            enabled: true,
                                            trigger: 'enter',
                                            skipDiacritics: true,
                                            placeholder: 'Fill and enter to search',
                                            
                                        }"
                                        :sort-options="{
                                            enabled: true,
                                            initialSortBy: {
                                                field: 'TASK_NUMBER',
                                                type: 'asc',
                                            }
                                        }"
                                        :select-options="{ enabled: false }"
                                        @on-search="onColumnSearch"
                                        @on-page-change="onPageChange"
                                        @on-sort-change="onSortChange"
                                        @on-column-filter="onColumnFilter"
                                        @on-per-page-change="onPerPageChange"
                                        :totalRows="detail_revision.totalRows"
                                        :pagination-options="{
                                            enabled: true,
                                            mode: 'pages',
                                            perPage: detail_revision.serverParams.perPage,
                                            position: 'bottom',
                                            perPageDropdown:  detail_revision.perPageDropDown,
                                            dropdownAllowAll: true,
                                            setCurrentPage: detail_revision.serverParams.page,
                                            nextLabel: 'Next',
                                            prevLabel: 'Prev',
                                            rowsPerPageLabel: 'Rows per page',
                                            ofLabel: 'of',
                                            pageLabel: 'page', // for 'pages' mode
                                            allLabel: 'All',
                                        }"
                                    >
                                    <template slot="table-row" slot-scope="props">
                                        <span v-if="props.column.field == 'DESCRIPTION'">
                                            {{handlerTextDescription(props.formattedRow['DESCRIPTION'])}}
                                        </span>    
                                        <span v-else-if="props.column.field == 'ACTION'">
                                            <div class="action">
                                                <i v-on:click="handleModalEditor(props.formattedRow['ID_AIRCRAFT'], props.formattedRow['TASK_NUMBER'] )" class="material-icons success edit-user">edit</i>
                                                <i v-on:click="handlerModalDetailMPD(props.formattedRow['ID_AIRCRAFT'], props.formattedRow['TASK_NUMBER'])" class="material-icons warning edit-password">visibility</i>
                                                <i class="material-icons disabled danger delete-user">delete</i>
                                            </div>
                                        </span>
                                    </template>
                                    </vue-good-table>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
      
            </div>

            <!-- Add New MPD -->
            <div v-if="isAddMPDShow">
                <div style="padding-bottom: 10px;">
                    <button v-on:click="handlerShowDetailRevision(detail_revision.serverParams.id_revision, detail_revision.serverParams.id_aircraft)">
                        <i class='material-icons'>
                            arrow_back
                        </i>
                        Back
                    </button>
                    <button class="button is-success" v-on:click="handlerSaveMPD()">
                        <i class='material-icons'>
                            save
                        </i>
                        Save
                    </button>
                </div>
                <div class="panel panel-default">
                    <loading style="margin-top: 50px;"
                        :active.sync="loading.isLoadingAddMPD" 
                        :can-cancel="false"
                        :is-full-page="true"
                        :color="loading.color"
                        :loader="loading.loaderType">
                    </loading>

                    <div class="panel-heading">
                        <div style="padding: 5px 0px 5px 0px;">
                            <div class="title-area">
                                Add MPD
                            </div>
                        </div>
                    </div>
                    <div style=""  class="panel-body">
                        <!-- DETAIL MPD -->
                        <div style="padding-bottom: 10px;">
                            <div class="card"> 
                                <h5>Detail MPD</h5>
                                <div class="is-table-container">
                                    <table style="width: 2800px;" class="is-striped is-bordered">
                                        <thead>
                                            <tr>
                                                <th width="3%">Rev Code <span class="is-req">*</span></th>
                                                <th width="3%">Section <span class="is-req">*</span></th>
                                                <th width="7%">MPD Number <span class="is-req">*</span></th>
                                                <th width="7%">Source Task Reference</th>
                                                <th width="4%">Skill Code</th>
                                                <th width="5%">Task Code</th>
                                                <th width="5%">Sample Threshold</th>
                                                <th width="5%">Sample Interval</th>
                                                <th width="5%">100% Threshold</th>
                                                <th width="5%">100% Interval</th>
                                                <th width="5%">Source</th>
                                                <th width="5%">TCI</th>
                                                <th width="5%">TPS</th>
                                                <th width="7%">PMPS <span class="is-req">*</span></th>
                                                <th width="7%">Reference <span class="is-req">*</span></th>
                                                <th width="5%">Applicability <span class="is-req">*</span></th>
                                                <th width="7%">Qual</th>
                                                <th width="9%">Remarks</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <select v-model="add.task.rev_code" name="" id="">
                                                        <option selected value="N">N</option>
                                                        <option value="R">R</option>
                                                        <option value="D">D</option>
                                                    </select>
                                                </td>
                                                <td><input v-model="add.task.section" type="text"></td>
                                                <td><input v-model="add.task.mpd_number" type="text"></td>
                                                <td><input v-model="add.task.source_task_reference" type="text"></td>
                                                <td><input v-model="add.task.skill_code" type="text"></td>
                                                <td><input v-model="add.task.task_code" type="text"></td>
                                                <td><input v-model="add.task.sample_threshold" type="text"></td>
                                                <td><input v-model="add.task.sample_interval" type="text"></td>
                                                <td><input v-model="add.task.full_threshold" type="text"></td>
                                                <td><input v-model="add.task.full_interval" type="text"></td>
                                                <td><input v-model="add.task.source" type="text"></td>
                                                <td><input v-model="add.task.tci" type="text"></td>
                                                <td><input v-model="add.task.tps" type="text"></td>
                                                <td><input v-model="add.task.pmps" type="text"></td>
                                                <td><input v-model="add.task.reference" type="text"></td>
                                                <td><input v-model="add.task.applicability" type="text"></td>
                                                <td><input v-model="add.task.qual" type="text"></td>
                                                <td><input v-model="add.task.remarks" type="text"></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <!-- DESCRIPTION -->
                        <div style="padding-bottom: 10px;">
                            <div class="card">
                                <h5>Description <span class="is-req">*</span></h5>
                                <textarea v-model="add.task.description" style="width: 100%;" name="" id="" rows="10"></textarea>
                            </div>
                        </div>
                        <!-- ZONE & ACCESS -->
                        <div class="is-row">
                            <div class="is-col is-50">
                                <div>
                                    <div class="card">
                                        <div class="card-header no-border">
                                            <div class="title-area">
                                                <h5>Detail Zone</h5> 
                                            </div>    
                                            <div class="option-box">
                                                <div class="option-item">
                                                    <button class="btn-add btn-add-row" v-on:click="addRowInsertZone()">
                                                        <i class="material-icons">add</i>   
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card-content is-table-fixed-add is-table-fixed-add-zone" style="box-sizing: border-box; height: 300px; overflow:hidden">
                                            <div class="is-table-container">
                                                <table class="is-striped is-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th width="40%">Zone <span class="is-req">*</span></th>
                                                            <th width="20%">Men <span class="is-req">*</span></th>
                                                            <th width="20%">MH <span class="is-req">*</span></th>
                                                            <th width="20%">Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>                                                    
                                                        <tr v-for="(list, index) in add.zone.rows" :key="index">
                                                            <td>
                                                                <input readonly placeholder="Click for add" class="edt-add-mpd-zone" v-on:click="handlerModalSelectAdd('Zone', 'ZONE', 'edt-add-mpd-zone', index, '/api/task/get_zone_by_name/')" type="text" v-model="list.zone">
                                                                <!-- <input v-on:click="handlerModalSelectAdd()" v-on:change="handlerCheckDuplicate(index, 'zone', 'zone')" type="text" v-model="list.zone"> -->
                                                            </td>
                                                            <td>
                                                                <input step="0.01" type="number" v-model="list.men">
                                                            </td>
                                                            <td>
                                                                <input type="number" min="1" v-model="list.mh">
                                                            </td>
                                                            <td align="center">
                                                                <div class="action">
                                                                    <i v-on:click="removeRowAddZone(index)" class="material-icons danger delete-user btn-core-delete">delete</i>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="is-col is-50">
                                <div>
                                    <div class="card">
                                         <div class="card-header no-border">
                                            <div class="title-area">
                                                <h5>Detail Access</h5>
                                            </div>    
                                            <div class="option-box">
                                                <div class="option-item">
                                                    <button class="btn-add btn-add-row" v-on:click="addRowInsertAccess()">
                                                        <i class="material-icons">add</i>   
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card-content is-table-fixed-add is-table-fixed-add-access" style="box-sizing: border-box; height: 300px; overflow:hidden">
                                            <div class="is-table-container">
                                                <table class="is-striped is-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th>Zone <span class="is-req">*</span></th>
                                                            <th>Access <span class="is-req">*</span></th>
                                                            <th>MENR <span class="is-req">*</span></th>
                                                            <th>MENI <span class="is-req">*</span></th>
                                                            <th>MHR<span class="is-req">*</span></th>
                                                            <th>MHI<span class="is-req">*</span></th>
                                                            <th>Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="(list, index) in add.access.rows" :key="index">
                                                            <td>
                                                                <select v-on:change="handlerCheckDuplicateMultiple(index, 'access', 'zone', 'access')"  v-model="list.zone">
                                                                    <option selected value="">Zone</option>
                                                                    <option v-for="(zone, index) in filterZone" :key="index" v-bind:value="zone.zone">{{ zone.zone}}</option>
                                                                </select>
                                                            </td>
                                                            <td>
                                                                <input readonly placeholder="Click for add" class="edt-add-mpd-access" v-on:click="handlerModalSelectAdd('Access', 'ACCESS', 'edt-add-mpd-access', index, '/api/task/get_access_by_name/')" type="text" v-model="list.access">
                                                                <!-- <input v-on:change="handlerCheckDuplicateMultiple(index, 'access', 'zone', 'access')" type="text" v-model="list.access"> -->
                                                            </td>
                                                            <td>
                                                                <input class="edt-add-mpd-access-men-remove" disabled step="0.01" type="number" v-model="list.men_remove">
                                                            </td>
                                                            <td>
                                                                <input class="edt-add-mpd-access-men-install" disabled step="0.01" type="number" v-model="list.men_install">
                                                            </td>
                                                            <td>
                                                                <input class="edt-add-mpd-access-mh-remove" disabled type="number" min="1" v-model="list.mh_remove">
                                                            </td>
                                                            <td>
                                                                <input class="edt-add-mpd-access-mh-install" disabled type="number" min="1" v-model="list.mh_install">
                                                            </td>
                                                            <td align="center">
                                                                <div class="action">
                                                                    <i v-on:click="removeRowAddAccess(index)" class="material-icons danger delete-user btn-core-delete">delete</i>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- PREPARATION & REFERENCE -->
                        <div class="is-row">
                            <div class="is-col is-50">
                                <div>
                                    <div class="card">
                                        <div class="card-header no-border">
                                            <div class="title-area">
                                                <h5>Detail Preparation</h5>
                                            </div>    
                                            <div class="option-box">
                                                <div class="option-item">
                                                    <button class="btn-add btn-add-row" v-on:click="addRowInsertPrep()">
                                                        <i class="material-icons">add</i>   
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card-content is-table-fixed-add is-table-fixed-add-prep" style="box-sizing: border-box; height: 300px; overflow:hidden">
                                            <div class="is-table-container">
                                                <table class="is-striped is-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th>Preparation <span class="is-req">*</span></th>
                                                            <th>MH <span class="is-req">*</span></th>
                                                            <th>Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="(list, index) in add.preparation.rows" :key="index">
                                                            <td>
                                                                <input readonly placeholder="Click for add" class="edt-add-mpd-preparation" v-on:click="handlerModalSelectAdd('Preparation', 'PREPARATION', 'edt-add-mpd-preparation', index, '/api/task/get_preparation_by_name/')" type="text" v-model="list.preparation">

                                                                <!-- <input v-on:change="handlerCheckDuplicate(index, 'preparation', 'preparation')" type="text" v-model="list.preparation"> -->
                                                            </td>
                                                            <td>
                                                                <input step="0.01" type="number" v-model="list.mh">
                                                            </td>
                                                            <td align="center">
                                                                <div class="action">
                                                                    <i v-on:click="removeRowAddPrep(index)" class="material-icons danger delete-user btn-core-delete">delete</i>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="is-col is-50">
                                <div>
                                    <div class="card">
                                        <div class="card-header no-border">
                                            <div class="title-area">
                                                <h5>Detail Reference</h5>
                                            </div>    
                                            <div class="option-box">
                                                <div class="option-item">
                                                    <button class="btn-add btn-add-row" v-on:click="addRowInsertRef()">
                                                        <i class="material-icons">add</i>   
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card-content is-table-fixed-add is-table-fixed-add-ref" style="box-sizing: border-box; height: 300px; overflow:hidden">
                                            <div class="is-table-container">
                                                <table class="is-striped is-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th>Reference Number <span class="is-req">*</span></th>
                                                            <th>Reference Information <span class="is-req">*</span></th>
                                                            <th>Men <span class="is-req">*</span></th>
                                                            <th>MH <span class="is-req">*</span></th>
                                                            <th>Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="(list, index) in add.reference.rows" :key="index">
                                                            <td>
                                                                <input v-on:change="handlerCheckDuplicate(index, 'reference', 'reference_number')" type="text" v-model="list.reference_number">
                                                            </td>
                                                            <td>
                                                                <input v-on:change="handlerCheckDuplicate(index, 'reference', 'reference_number')" type="text" v-model="list.reference_information">
                                                            </td>
                                                            <td>
                                                                <input step="0.01" type="number" v-model="list.men">
                                                            </td>
                                                            <td>
                                                                <input step="0.01" type="number" v-model="list.mh">
                                                            </td>
                                                            <td align="center">
                                                                <div class="action">
                                                                    <i v-on:click="removeRowAddRef(index)" class="material-icons danger delete-user btn-core-delete">delete</i>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- PART -->
                        <div class="is-row">
                            <div class="is-col is-30">
                                <div class="card">
                                    <div class="card-header no-border">
                                        <div class="title-area">
                                            <h5>Task Part</h5>
                                        </div>    
                                        <div class="option-box">
                                            <div class="option-item">
                                                <button class="btn-add btn-add-row" v-on:click="addRowInsertPart()">
                                                    <i class="material-icons">add</i>   
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-content is-table-fixed-add-part-panel is-table-fixed-add-part" style="box-sizing: border-box; height: 260px; overflow:hidden">
                                        <div class="is-table-container">
                                            <table class="is-striped is-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>Part Number <span class="is-req">*</span></th>
                                                        <th>Type <span class="is-req">*</span></th>
                                                        <th>QTY <span class="is-req">*</span></th>
                                                        <th>Action</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr v-for="(list, index) in add.part.rows" :key="index">
                                                        <td>
                                                            <input readonly placeholder="Click for add" class="edt-add-mpd-part" v-on:click="handlerModalSelectAdd('Part', 'PART_NUMBER', 'edt-add-mpd-part', index, '/api/task/get_material_by_name/')" type="text" v-model="list.part_number">
                                                            <!-- <input v-on:change="handlerCheckDuplicate(index, 'part', 'part_number')" type="text" v-model="list.part_number"> -->
                                                        </td>
                                                        <td>
                                                            <input class="edt-add-mpd-part-type" readonly type="text" v-model="list.type">
                                                        </td>
                                                        <td>
                                                            <input min="1" type="number" v-model="list.qty">
                                                        </td>
                                                        <td align="center">
                                                            <div class="action">
                                                                <i v-on:click="removeRowAddPart(index)" class="material-icons danger delete-user btn-core-delete">delete</i>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="is-col is-30">
                                <div class="card">
                                    <div class="card-header no-border">
                                        <div class="title-area">
                                            <h5>Preparation Part</h5>
                                        </div>    
                                        <div class="option-box">
                                            <div class="option-item">
                                                <button class="btn-add btn-add-row" v-on:click="addRowInsertPrepPart()">
                                                    <i class="material-icons">add</i>   
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-content is-table-fixed-add-part-panel is-table-fixed-add-preppart" style="box-sizing: border-box; height: 260px; overflow:hidden">
                                        <div class="is-table-container">
                                            <table class="is-striped is-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>Preparation <span class="is-req">*</span></th>
                                                        <th>Part Number <span class="is-req">*</span></th>
                                                        <th>Type <span class="is-req">*</span></th>
                                                        <th>Qty <span class="is-req">*</span></th>
                                                        <th>Action</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr v-for="(list, index) in add.preppart.rows" :key="index">
                                                        <td>
                                                            <select v-on:change="handlerCheckDuplicateMultiple(index, 'preppart', 'preparation', 'part_number')"  v-model="list.preparation">
                                                                <option selected value="">Preparation</option>
                                                                <option v-for="(prep, index) in filterPrep" :key="index" v-bind:value="prep.preparation">{{ prep.preparation}}</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <input readonly placeholder="Click for add" class="edt-add-mpd-prep-part" v-on:click="handlerModalSelectAdd('Part', 'PART_NUMBER', 'edt-add-mpd-prep-part', index, '/api/task/get_material_by_name/')" type="text" v-model="list.part_number">

                                                            <!-- <input v-on:change="handlerCheckDuplicateMultiple(index, 'preppart', 'preparation', 'part_number')" type="text" v-model="list.part_number"> -->
                                                        </td>
                                                        <td>
                                                            <input readonly  class="edt-add-mpd-prep-part-type" type="text" v-model="list.type">
                                                        </td>
                                                        <td>
                                                            <input type="number" min="1" v-model="list.qty">
                                                        </td>
                                                        <td align="center">
                                                            <div class="action">
                                                                <i v-on:click="removeRowAddPrepPart(index)" class="material-icons danger delete-user btn-core-delete">delete</i>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="is-col is-30">
                                <div class="card">
                                     <div class="card-header no-border">
                                        <div class="title-area">
                                            <h5>Materials</h5>
                                        </div>    
                                        <div class="option-box">
                                            <div class="option-item">
                                                <button class="btn-add btn-add-row" v-on:click="addRowInsertMaterial()">
                                                    <i class="material-icons">add</i>   
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-content is-table-fixed-add-part-panel  is-table-fixed-add-refpart" style="box-sizing: border-box; height: 260px; overflow:hidden">
                                        <div class="is-table-container">
                                            <table class="is-striped is-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>Material Number <span class="is-req">*</span></th>
                                                        <th>Part Number <span class="is-req">*</span></th>
                                                        <th>Status <span class="is-req">*</span></th>
                                                        <th>Action</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr v-for="(list, index) in add.material.rows" :key="index">
                                                        <td>
                                                            <input v-on:change="handlerCheckDuplicateMultiple(index, 'material', 'material_number', 'part_number')" type="text" v-model="list.material_number">
                                                        </td>
                                                        <td>
                                                            <select v-on:change="handlerCheckDuplicateMultiple(index, 'material', 'material_number', 'part_number')"  v-model="list.part_number">
                                                                <option selected value="">Part Number</option>
                                                                <option v-for="(part, index) in filterPart" :key="index" v-bind:value="part.part_number">{{ part.part_number}}</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select v-model="list.status" name="" id="">
                                                                <option value="">Status</option>
                                                                <option value="1">Countable</option>
                                                                <option value="0">Uncountable</option>
                                                            </select>
                                                        </td>
                                                        <td align="center">
                                                            <div class="action">
                                                                <i v-on:click="removeRowAddMaterial(index)" class="material-icons danger delete-user btn-core-delete">delete</i>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    </tbody>    
                                            </table>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
                <div style="width: 100%">
                    <button style="width: 100%" class="button is-success" v-on:click="handlerSaveMPD()">
                        <i class='material-icons'>
                            save
                        </i>
                        Save
                    </button>
                </div>
            </div>

            <!-- Modal editor -->
            <div class="modal-box" id="modal-editor" style="margin-top: -20px;">
                <div class="modal lg">
                    <span class="close" v-on:click="hideModal('modal-editor')"></span>
                        <div class="modal-header">
                            <h2 class="title">Database Editor</h2>
                        </div>
                        <div class="modal-body modal-editor" style="position: relative">
                            <div class="option-box">
                                <div class="option-item">
                                    <span style="white-space: nowrap">Aircraft Type</span>
                                    <select disabled id="aircraft-type" v-model="form_editor.aircraft_type">
                                        <option value="" disabled selected>A/C Type</option>
                                        <option v-for="aircraft in aircrafts" :key="aircraft.ID" v-bind:value="aircraft.ID">{{ aircraft.AIRCRAFT }}</option>
                                    </select>
                                </div>
                                <div class="option-item">
                                    <span style="white-space: nowrap">Editor Type</span>
                                    <select v-model="editor_type" id="aircraft-type">
                                        <option value="" disabled selected>Editor Type</option>
                                        <!-- <option value="description">Description</option> -->
                                        <option value="core_task">Core Task</option>
                                        <option value="preparation">Preparation</option>
                                        <option value="access">Access</option>
                                        <option value="material_tools">Core Part</option>
                                        <option value="core_material">Core Material</option>
                                        <option value="material_prep">Prep Part</option>
                                        <option value="reference">Reference</option>
                                        <!-- <option value="material_ref">Ref Material</option> -->
                                    </select>
                                </div>
                                <div class="option-item">
                                    <span style="white-space: nowrap">MPD Number</span>
                                    <input v-model="form_editor.mpd_number" class="" id="editor-mpd-number" name="edt-mpd-number" placeholder="">
                                </div>
                                <div class="option-item">
                                    <button style="width: 140px;" v-on:click="handleFindEditor()">
                                        <i class="material-icons">search</i>
                                        Search
                                    </button>
                                </div>
                            </div>
                            <hr style="padding: 15px 0px 0px 0px; margin-right: -15px; margin-left: -15px;">
                            <loading style="margin-top: 50px;"
                                :active.sync="loading.isLoadingEditor" 
                                :can-cancel="false"
                                :is-full-page="false"
                                :color="loading.color"
                                :loader="loading.loaderType">
                            </loading>
                            <!-- panel core editor -->
                            <div id="core-task" v-if="editor.core.isShow">
                                <div class="is-row">
                                    <div class="is-col is-35">
                                        <div class="card">
                                            <div class="card-header no-border">
                                                Master Zone
                                            </div>
                                            <div class="card-content" style="box-sizing: border-box; height: 295px; overflow:hidden">
                                                <template>
                                                    <div>
                                                        <vue-good-table
                                                            :columns="editor.core.field"
                                                            :rows="editor.core.zone"
                                                            max-height="215px"
                                                            :fixed-header="true"
                                                            styleClass="vgt-table bordered striped"
                                                            
                                                            :search-options="{
                                                                enabled: true,
                                                                trigger: 'keyup',
                                                                skipDiacritics: true,
                                                                placeholder: 'Fill to search'
                                                            }"
                                                            :pagination-options="{
                                                                enabled: true,
                                                                mode: 'records',
                                                                perPage: 10,
                                                                position: 'bottom',
                                                                perPageDropdown: editor.perPage,
                                                                dropdownAllowAll: true,
                                                                setCurrentPage: 1,
                                                                nextLabel: '',
                                                                prevLabel: '',
                                                                rowsPerPageLabel: '',
                                                                ofLabel: 'of',
                                                                pageLabel: '', // for 'pages' mode
                                                                allLabel: 'All',
                                                            }"
                                                        >
                                                        </vue-good-table>

                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="is-col is-65">
                                        <div class="card">
                                            <div class="card-header no-border">
                                                <div class="title-area">
                                                    Detail Task Zone
                                                </div>    
                                                <div class="option-box">
                                                    <div class="option-item">
                                                        <button class="btn-add btn-add-row" v-on:click="addRowCore(editor.core.detail_zone.length+1)">
                                                            <i class="material-icons">add</i>   
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-content is-table-fixed is-table-fixed-core" style="box-sizing: border-box; height: 285px; overflow:hidden">
                                                <table style="font-size: 9pt;" class="is-striped is-bordered" id="table-zone">
                                                    <thead> 
                                                        <tr>
                                                            <th style="text-align: center;" width="20%">Zone <span class="is-req">*</span></th>
                                                            <th style="text-align: center;">Men <span class="is-req">*</span></th>
                                                            <th style="text-align: center;">MH <span class="is-req">*</span></th>
                                                            <th style="text-align: center;" width="20%">Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="(list, index) in editor.core.detail_zone" :key="list.IDX">
                                                            <td>
                                                                <input  type="hidden"  class="edt-core-id" v-bind:value="list.ID">
                                                                <input  v-model="list.ID_ZONE" readonly type="hidden" name="" class="edt-core-zone" >
                                                                <input v-on:click="handlerModalSelect('Zone', 'ZONE', 'edt-core-zone', 'edt-core-zone-select', index, '/api/task/get_zone_by_name/', 'ID', 'ZONE')" placeholder="Click for add" readonly  type="text" :disabled="list.ID !== ''"  v-model="list.ZONE" class="edt-core-zone-select">
                                                                <!-- <select v-on:click="handlerModalSelect()" style="font-size: 9pt" v-bind:value="core.ID"  :disabled="list.ID !== ''" id="edt-core-zone" class="edt-core-zone">
                                                                    <option v-for="core in editor.core.zone" :selected="core.ZONE == list.ZONE" :key="core.ID" v-bind:value="core.ID">{{ core.ZONE}}</option>
                                                                </select> -->
                                                            </td>
                                                            <td>
                                                                <input style="font-size: 9pt"  type="number" min="1" class="edt-core-men" v-model="list.MEN">
                                                            </td>
                                                            <td>
                                                                <input style="font-size: 9pt" type="number" step="0.01"  class="edt-core-mh" v-model="list.MH">
                                                            </td>
                                                            <td align="center">
                                                                <div class="action">
                                                                    <i v-if="list.ID !== ''" v-on:click="postCore(index, 'update')" class="material-icons success edit-user">edit</i>
                                                                    <i v-else v-on:click="postCore(index, 'insert')" class="material-icons success edit-user">edit</i>
                                                                    <i v-on:click="removeRowCore(index, list.ID)" class="material-icons danger delete-user btn-core-delete">delete</i>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- panel preparation editor -->
                            <div id="preparation" v-if="editor.preparation.isShow">
                                <div class="is-row">
                                    <div class="is-col is-35">
                                        <div class="card">
                                            <div class="card-header no-border">
                                                Master Preparation
                                            </div>
                                            <div class="card-content" style="box-sizing: border-box; height: 295px; overflow:hidden">
                                                <template>
                                                    <div>
                                                        <vue-good-table
                                                            :columns="editor.preparation.field"
                                                            :rows="editor.preparation.preparation"
                                                            max-height="215px"
                                                            :fixed-header="true"
                                                            styleClass="vgt-table bordered striped"
                                                            
                                                            :search-options="{
                                                                enabled: true,
                                                                trigger: 'keyup',
                                                                skipDiacritics: true,
                                                                placeholder: 'Fill to search'
                                                            }"
                                                            :pagination-options="{
                                                                enabled: true,
                                                                mode: 'records',
                                                                perPage: 10,
                                                                position: 'bottom',
                                                                perPageDropdown: editor.perPage,
                                                                dropdownAllowAll: true,
                                                                setCurrentPage: 1,
                                                                nextLabel: '',
                                                                prevLabel: '',
                                                                rowsPerPageLabel: '',
                                                                ofLabel: 'of',
                                                                pageLabel: '', // for 'pages' mode
                                                                allLabel: 'All',
                                                            }"
                                                        >
                                                        </vue-good-table>

                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="is-col is-65">
                                        <div class="card">
                                            <div class="card-header no-border">
                                                <div class="title-area">
                                                    Detail Task Preparation
                                                </div>    
                                                <div class="option-box">
                                                    <div class="option-item">
                                                        <button class="btn-add btn-add-row" v-on:click="addRowPreparation(editor.preparation.detail_preparation.length+1)">
                                                            <i class="material-icons">add</i>   
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-content is-table-fixed is-table-fixed-prep" style="box-sizing: border-box; height: 287px; overflow:hidden">
                                                <table style="font-size: 9pt;"  class="is-striped is-bordered " id="table-zone">
                                                    <thead>
                                                        <tr>
                                                            <th style="text-align: left;" width="60%">Preparation <span class="is-req">*</span></th>
                                                            <th width="20%" style="text-align: center;">MH <span class="is-req">*</span></th>
                                                            <th style="text-align: center;" width="20%">Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="(list, index) in editor.preparation.detail_preparation" :key="list.IDX">
                                                            <td>
                                                                <input  type="hidden"  class="edt-preparation-id" v-bind:value="list.ID">
                                                                <input  v-model="list.ID_PREPARATION" readonly type="hidden" name="" class="edt-preparation-preparation" >
                                                                <input v-on:click="handlerModalSelect('Preparation', 'PREPARATION', 'edt-preparation-preparation', 'edt-preparation-preparation-select', index, '/api/task/get_preparation_by_name/', 'ID', 'PREPARATION')" placeholder="Click for add" readonly  type="text" :disabled="list.ID !== ''"  v-model="list.PREPARATION" class="edt-preparation-preparation-select">
                                                                <!-- <select style="font-size: 9pt" :disabled="list.ID !== ''" id="edt-preparation-preparation" class="edt-preparation-preparation">
                                                                    <option v-for="prep in editor.preparation.preparation" :selected="prep.PREPARATION == list.PREPARATION" :key="prep.ID" v-bind:value="prep.ID">{{ prep.PREPARATION}}</option>
                                                                </select> -->
                                                            </td>
                                                            <td>
                                                                <input style="font-size: 9pt"  type="number" min="1" class="edt-preparation-mh" v-model="list.PREP_M_H">
                                                            </td>
                                                            <td align="center">
                                                                <div class="action">
                                                                    <i v-if="list.ID !== ''" v-on:click="postPreparation(index, 'update')" class="material-icons success edit-user">edit</i>
                                                                    <i v-else v-on:click="postPreparation(index, 'insert')" class="material-icons success edit-user">edit</i>
                                                                    <i v-on:click="removeRowPreparation(index, list.ID)" class="material-icons danger delete-user btn-core-delete">delete</i>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                            <!-- panel part editor -->
                            <div id="material" v-if="editor.material.isShow">
                                <div class="is-row">
                                    <div class="is-col is-35">
                                        <div class="card">
                                            <div class="card-header no-border">
                                                Master Part
                                            </div>
                                            <div class="card-content" style="box-sizing: border-box; height: 295px; overflow:hidden">
                                                <template>
                                                    <div>
                                                        <vue-good-table
                                                            :columns="editor.material.field"
                                                            :rows="editor.material.part"
                                                            max-height="215px"
                                                            styleClass="vgt-table bordered striped"
                                                            
                                                            :search-options="{
                                                                enabled: true,
                                                                trigger: 'keyup',
                                                                skipDiacritics: true,
                                                                placeholder: 'Fill to search'
                                                            }"
                                                            :pagination-options="{
                                                                enabled: true,
                                                                mode: 'records',
                                                                perPage: 10,
                                                                position: 'bottom',
                                                                perPageDropdown: editor.perPage,
                                                                dropdownAllowAll: true,
                                                                setCurrentPage: 1,
                                                                nextLabel: '',
                                                                prevLabel: '',
                                                                rowsPerPageLabel: '',
                                                                ofLabel: 'of',
                                                                pageLabel: '', // for 'pages' mode
                                                                allLabel: 'All',
                                                            }"
                                                        >
                                                        </vue-good-table>

                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="is-col is-65">
                                        <div class="card">
                                            <div class="card-header no-border">
                                                <div class="title-area">
                                                    Detail Task Material
                                                </div>    
                                                <div class="option-box">
                                                    <div class="option-item">
                                                        <button class="btn-add btn-add-row" v-on:click="addRowMaterial(editor.material.detail_material.length+1)">
                                                            <i class="material-icons">add</i>   
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-content is-table-fixed is-table-fixed-material" style="box-sizing: border-box; height: 285px; overflow:hidden">
                                                <table style="font-size: 9pt;" class="is-striped is-bordered" id="table-zone">
                                                    <thead>
                                                        <tr>
                                                            <th style="text-align: left;">Part Number <span class="is-req">*</span></th>
                                                            <th style="text-align: center;">QTY <span class="is-req">*</span></th>
                                                            <th style="text-align: center;">Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="(list, index) in editor.material.detail_material" :key="list.IDX">
                                                            <td>
                                                                <input type="hidden" class="edt-material-id" v-bind:value="list.ID">
                                                                <input  v-model="list.ID_PART" readonly type="hidden" name="" class="edt-material-part" >
                                                                <input v-on:click="handlerModalSelect('Material', 'PART_NUMBER', 'edt-material-part', 'edt-material-part-select', index, '/api/task/get_material_by_name/', 'ID', 'PART_NUMBER')" placeholder="Click for add" readonly  type="text" :disabled="list.ID !== ''"  v-model="list.PART_NUMBER" class="edt-material-part-select">
                                                                
                                                                <!-- <select style="font-size: 9pt" :disabled="list.ID !== ''" id="edt-material-part" class="edt-material-part">
                                                                    <option v-for="part in editor.material.part" :selected="part.PART_NUMBER == list.PART_NUMBER" :key="part.ID" v-bind:value="part.ID">{{ part.PART_NUMBER}}</option>
                                                                </select> -->
                                                            </td>
                                                            <td>
                                                                <input style="font-size: 9pt"  type="number" min="1" class="edt-material-qty" v-model="list.QTY">
                                                            </td>
                                                            <td align="center">
                                                                <div class="action">
                                                                    <i v-if="list.ID !== ''" v-on:click="postMaterial(index, 'update')" class="material-icons success edit-user">edit</i>
                                                                    <i v-else v-on:click="postMaterial(index, 'insert')" class="material-icons success edit-user">edit</i>
                                                                    <i v-on:click="removeRowMaterial(index, list.ID, list.TASK_TYPE)" class="material-icons danger delete-user btn-core-delete">delete</i>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- panel  material editor -->
                            <div id="core_material" v-if="editor.core_material.isShow">
                                <div class="card">
                                    <div class="card-header no-border">
                                        <div class="title-area">
                                            Master Core Material
                                        </div>    
                                        <div class="option-box">
                                            <div class="option-item">
                                                <button class="btn-add btn-add-row" v-on:click="addRowCoreMaterial(editor.core_material.detail_core_material.length+1)">
                                                    <i class="material-icons">add</i>   
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-content is-table-fixed is-table-fixed-core-material" style="box-sizing: border-box; height: 285px; overflow:hidden">
                                        <table style="font-size: 9pt;" class="is-striped is-bordered" id="table-zone">
                                            <thead>
                                                <tr>
                                                    <th style="text-align: left;" width="12%">Material Number <span class="is-req">*</span></th>
                                                    <th width="35%" style="text-align: left;">Part Number <span class="is-req">*</span></th>
                                                    <th style="text-align: center;" width="12%">Status <span class="is-req">*</span></th>
                                                    <th style="text-align: center;" width="18%">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr v-for="(list, index) in editor.core_material.detail_core_material" :key="list.IDX">
                                                    <td>
                                                        <input type="hidden" class="edt-material-core-id" v-bind:value="list.ID">
                                                        <input style="font-size: 9pt"  type="text" min="1" class="edt-material-core-number" v-model="list.MATERIAL_NUMBER">
                                                    </td>
                                                    <td>
                                                        <input  v-model="list.ID_DET_TASK_PART" readonly type="hidden" name="" class="edt-material-core-part" >
                                                        <input v-on:click="handlerModalSelect('Part', 'PART_NUMBER', 'edt-material-core-part', 'edt-material-core-part-select', index, '/api/task/get_detail_material_by_name', 'ID', 'PART_NUMBER')" placeholder="Click for add" readonly  type="text" :disabled="list.ID !== ''"  v-model="list.PART_NUMBER" class="edt-material-core-part-select">
                                                        <!-- <select style="font-size: 9pt" :disabled="list.ID !== ''" id="edt-material-core-part" class="edt-material-core-part">
                                                            <option v-for="part in editor.material.detail_material" :selected="part.PART_NUMBER == list.PART_NUMBER" :key="part.IDX" v-bind:value="part.ID">{{ part.PART_NUMBER}}</option>
                                                        </select> -->
                                                    </td>
                                                    <td>
                                                        <select class="edt-material-core-status" v-model="list.STATUS">
                                                            <option selected value="">Status</option>
                                                            <option value="1">Countable</option>
                                                            <option value="0">Uncountable</option>
                                                        </select>
                                                    </td>
                                                    <td align="center">
                                                        <div class="action">
                                                            <i v-if="list.ID !== ''" v-on:click="postCoreMaterial(index, 'update')" class="material-icons success edit-user">edit</i>
                                                            <i v-else v-on:click="postCoreMaterial(index, 'insert')" class="material-icons success edit-user">edit</i>
                                                            <i v-on:click="removeRowCoreMaterial(index, list.ID)" class="material-icons danger delete-user btn-core-delete">delete</i>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div style="height: 10px;"></div>
                            </div>

                            <!-- panel access editor -->
                            <div id="access" v-if="editor.access.isShow">
                                <div class="is-row">
                                    <div class="is-col is-33">
                                        <div class="card">
                                            <div class="card-header no-border">
                                                Master Access
                                            </div>
                                            <div class="card-content" style="box-sizing: border-box; height: 295px; overflow:hidden">
                                                <template>
                                                    <div>
                                                        <vue-good-table
                                                            :columns="editor.access.field"
                                                            :rows="editor.access.access"
                                                            max-height="215px"
                                                            styleClass="vgt-table bordered striped"
                                                            
                                                            :search-options="{
                                                                enabled: true,
                                                                trigger: 'keyup',
                                                                skipDiacritics: true,
                                                                placeholder: 'Fill to search'
                                                            }"
                                                            :pagination-options="{
                                                                enabled: true,
                                                                mode: 'records',
                                                                perPage: 10,
                                                                position: 'bottom',
                                                                perPageDropdown: editor.perPage,
                                                                dropdownAllowAll: true,
                                                                setCurrentPage: 1,
                                                                nextLabel: '',
                                                                prevLabel: '',
                                                                rowsPerPageLabel: '',
                                                                ofLabel: 'of',
                                                                pageLabel: '', // for 'pages' mode
                                                                allLabel: 'All',
                                                            }"
                                                        >
                                                        </vue-good-table>

                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="is-col is-67">
                                        <div class="card">
                                            <div class="card-header no-border">
                                                <div class="title-area">
                                                    Detail Task Access
                                                </div>    
                                                <div class="option-box">
                                                    <div class="option-item">
                                                        <button class="btn-add btn-add-row" v-on:click="addRowAccess(editor.access.detail_access.length+1)">
                                                            <i class="material-icons">add</i>   
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-content is-table-fixed is-table-fixed-access" style="box-sizing: border-box; height: 285px; overflow:hidden">
                                                <table style="font-size: 9pt;" class="is-striped is-bordered" id="table-zone">
                                                    <thead>
                                                        <tr>
                                                            <th style="text-align: center;">Zone <span class="is-req">*</span></th>
                                                            <th style="text-align: center;">Access <span class="is-req">*</span></th>
                                                            <th style="text-align: center;" >MNR <span class="is-req">*</span></th>
                                                            <th style="text-align: center;" >MNI <span class="is-req">*</span></th>
                                                            <th style="text-align: center;" >MHR <span class="is-req">*</span></th>
                                                            <th style="text-align: center;" >MHI <span class="is-req">*</span></th>
                                                            <th style="text-align: center;" >Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="(list, index) in editor.access.detail_access" :key="list.IDX">
                                                            <td>
                                                                <input  type="hidden"  class="edt-det_access-id" v-bind:value="list.ID">
                                                                <select style="font-size: 9pt" :disabled="list.ID !== ''" id="edt-access-zone" class="edt-access-zone">
                                                                    <option v-for="access_zone in editor.access.detail_zone" :selected="access_zone.ZONE == list.ZONE" :key="access_zone.ID" v-bind:value="access_zone.ID_DET_ZONE">{{ access_zone.ZONE}}</option>
                                                                </select>
                                                            </td>
                                                            <td>
                                                                <input  v-model="list.ID_ACCESS" readonly type="hidden" name="" class="edt-access-access" >
                                                                <input v-on:click="handlerModalSelect('Access', 'ACCESS', 'edt-access-access', 'edt-access-access-select', index, '/api/task/get_access_by_name', 'ID', 'ACCESS')" placeholder="Click for add" readonly  type="text" :disabled="list.ID !== ''"  v-model="list.ACCESS" class="edt-access-access-select">
                                                                <!-- <select v-on:change="handlerChangeAccess(index)" style="font-size: 9pt" :disabled="list.ID !== ''" id="edt-access-access" class="edt-access-access">
                                                                    <option v-for="access in editor.access.access" :selected="access.ACCESS == list.ACCESS" :key="access.ID" v-bind:value="access.ID">{{ access.ACCESS}}</option>
                                                                </select> -->
                                                            </td>
                                                            <td>
                                                                <input v-if="list.ID !== ''" style="font-size: 9pt"  type="number" min="1" class="edt-access-men" v-model="list.MEN">
                                                                <input v-else style="font-size: 9pt" disabled  type="number" min="1" class="edt-access-men" v-model="editor.access.access[0].MEN">
                                                            </td>
                                                            <td>
                                                                <input v-if="list.ID !== ''" style="font-size: 9pt"  type="number" min="1" class="edt-access-men-install" v-model="list.MEN_INSTALL">
                                                                <input v-else style="font-size: 9pt" disabled  type="number" min="1" class="edt-access-men-install" v-model="editor.access.access[0].MEN_INSTALL">
                                                            </td>
                                                            <td>
                                                                <input v-if="list.ID !== ''" style="font-size: 9pt"  type="number" min="1" class="edt-access-mhrs" v-model="list.MH">
                                                                <input v-else style="font-size: 9pt" disabled  type="number" min="1" class="edt-access-mhrs" v-model="editor.access.access[0].MH">
                                                            </td>
                                                            <td>
                                                                <input v-if="list.ID !== ''" style="font-size: 9pt"  type="number" min="1" class="edt-access-mhrs-install" v-model="list.MH_INSTALL">
                                                                <input v-else style="font-size: 9pt" disabled  type="number" min="1" class="edt-access-mhrs-install" v-model="editor.access.access[0].MH_INSTALL">
                                                            </td>
                                                            <td align="center">
                                                                <div class="action">
                                                                    <i v-if="list.ID !== ''" v-on:click="postAccess(index, 'update')" class="material-icons success edit-user">edit</i>
                                                                    <i v-else v-on:click="postAccess(index, 'insert')" class="material-icons success edit-user">edit</i>
                                                                    <i v-on:click="removeRowAccess(index, list.ID)" class="material-icons danger delete-user btn-core-delete">delete</i>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- panel material preparation editor -->
                             <div id="material" v-if="editor.material_prep.isShow">
                                 <div class="is-row">
                                     <div class="is-col is-35">
                                         <div class="card">
                                             <div class="card-header no-border">
                                                 Master Part
                                             </div>
                                             <div class="card-content"
                                                 style="box-sizing: border-box; height: 295px; overflow:hidden">
                                                 <template>
                                                     <div>
                                                         <vue-good-table :columns="editor.material_prep.field"
                                                             :rows="editor.material.part" max-height="215px"
                                                             styleClass="vgt-table bordered striped" :search-options="{
                                                                enabled: true,
                                                                trigger: 'keyup',
                                                                skipDiacritics: true,
                                                                placeholder: 'Fill to search'
                                                            }" :pagination-options="{
                                                                enabled: true,
                                                                mode: 'records',
                                                                perPage: 10,
                                                                position: 'bottom',
                                                                perPageDropdown: editor.perPage,
                                                                dropdownAllowAll: true,
                                                                setCurrentPage: 1,
                                                                nextLabel: '',
                                                                prevLabel: '',
                                                                rowsPerPageLabel: '',
                                                                ofLabel: 'of',
                                                                pageLabel: '', // for 'pages' mode
                                                                allLabel: 'All',
                                                            }">
                                                         </vue-good-table>

                                                     </div>
                                                 </template>
                                             </div>
                                         </div>
                                     </div>

                                     <div class="is-col is-65">
                                         <div class="card">
                                             <div class="card-header no-border">
                                                 <div class="title-area">
                                                     Detail Preparation Task Material
                                                 </div>
                                                 <div class="option-box">
                                                     <div class="option-item">
                                                         <button class="btn-add btn-add-row"
                                                             v-on:click="addRowMaterialPrep(editor.material_prep.detail_material_prep.length+1)">
                                                             <i class="material-icons">add</i>
                                                         </button>
                                                     </div>
                                                 </div>
                                             </div>
                                             <div class="card-content is-table-fixed is-table-fixed-material-prep"
                                                 style="box-sizing: border-box; height: 285px; overflow:hidden">
                                                 <table style="font-size: 9pt;" class="is-striped is-bordered"
                                                     id="table-zone">
                                                     <thead>
                                                         <tr>
                                                             <th style="text-align: left;">Preparation <span class="is-req">*</span></th>
                                                             <th  style="text-align: left;">Part Number <span class="is-req">*</span></th>
                                                             <th style="text-align: center;" >QTY <span class="is-req">*</span></th>
                                                             <th style="text-align: center;">Action</th>
                                                         </tr>
                                                     </thead>
                                                     <tbody>
                                                         <tr v-for="(list, index) in editor.material_prep.detail_material_prep"
                                                             :key="list.IDX">
                                                             <td>
                                                                <input type="hidden" class="edt-material-prep-id" v-bind:value="list.ID">
                                                                <input  v-model="list.ID_PREPARATION" readonly type="hidden" name="" class="edt-material-preparation" >
                                                                <input v-on:click="handlerModalSelect('Preparation', 'PREPARATION', 'edt-material-preparation', 'edt-material-preparation-select', index, '/api/task/get_preparation_by_name/', 'ID', 'PREPARATION')" placeholder="Click for add" readonly  type="text" :disabled="list.ID !== ''"  v-model="list.PREPARATION" class="edt-material-preparation-select">    
                                                                 
                                                                 <!-- <select style="font-size: 9pt"
                                                                     :disabled="list.ID !== ''"
                                                                     id="edt-material-preparation"
                                                                     class="edt-material-preparation">
                                                                     <option
                                                                         v-for="prep in editor.preparation.detail_preparation"
                                                                         :selected="prep.PREPARATION == list.PREPARATION"
                                                                         :key="prep.IDX" v-bind:value="prep.ID">
                                                                         {{ prep.PREPARATION}}</option>
                                                                 </select> -->
                                                             </td>
                                                             <td>
                                                                 <input  v-model="list.ID_PART" readonly type="hidden" name="" class="edt-material-prep-part" >
                                                                <input v-on:click="handlerModalSelect('Part', 'PART_NUMBER', 'edt-material-prep-part', 'edt-material-prep-part-select', index, '/api/task/get_material_by_name/', 'ID', 'PART_NUMBER')" placeholder="Click for add" readonly  type="text" :disabled="list.ID !== ''"  v-model="list.PART_NUMBER" class="edt-material-prep-part-select">
                                                                 <!-- <select style="font-size: 9pt"
                                                                     :disabled="list.ID !== ''"
                                                                     id="edt-material-prep-part"
                                                                     class="edt-material-prep-part">
                                                                     <option v-for="part in editor.material.part"
                                                                         :selected="part.PART_NUMBER == list.PART_NUMBER"
                                                                         :key="part.ID" v-bind:value="part.ID">
                                                                         {{ part.PART_NUMBER}}</option>
                                                                 </select> -->
                                                             </td>
                                                             <td>
                                                                 <input style="font-size: 9pt" type="number" min="1"
                                                                     class="edt-material-prep-qty"
                                                                     v-model="list.QTY">
                                                             </td>
                                                             <td align="center">
                                                                 <div class="action">
                                                                     <i v-if="list.ID !== ''"
                                                                         v-on:click="postMaterialPrep(index, 'update')"
                                                                         class="material-icons success edit-user">edit</i>
                                                                     <i v-else
                                                                         v-on:click="postMaterialPrep(index, 'insert')"
                                                                         class="material-icons success edit-user">edit</i>
                                                                     <i v-on:click="removeRowMaterialPrep(index, list.ID)"
                                                                         class="material-icons danger delete-user btn-core-delete">delete</i>
                                                                 </div>
                                                             </td>
                                                         </tr>
                                                     </tbody>
                                                 </table>
                                             </div>
                                         </div>
                                     </div>
                                 </div>
                             </div>

                             <!-- panel reference editor -->
                             <div id="reference" v-if="editor.reference.isShow">
                                 <div class="is-row" style="margin-right: 15px;">
                                     <div class="is-col is-100">
                                        <div class="card">
                                            <div class="card-header no-border">
                                                <div class="title-area">
                                                    Detail Task Reference
                                                </div>    
                                                <div class="option-box">
                                                    <div class="option-item">
                                                        <button class="btn-add btn-add-row" v-on:click="addRowReference(editor.reference.detail_reference.length+1)">
                                                            <i class="material-icons">add</i>   
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-content is-table-fixed is-table-fixed-ref" style="box-sizing: border-box; height: 285px; overflow:hidden">
                                                <table style="font-size: 9pt;"  class="is-striped is-bordered " id="table-zone">
                                                    <thead>
                                                        <tr>
                                                            <th nowrap >Reference Number <span class="is-req">*</span></th>
                                                            <th nowrap >Reference Information <span class="is-req">*</span></th>
                                                            <th nowrap style="text-align: center;">Men <span class="is-req">*</span></th>
                                                            <th nowrap style="text-align: center;">Mh <span class="is-req">*</span></th>
                                                            <th nowrap style="text-align: center;" >Action</th> 
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="(list, index) in editor.reference.detail_reference" :key="list.IDX">
                                                            <td>
                                                                <input  type="hidden"  class="edt-reference-id" v-model="list.ID">
                                                                <input v-model="list.REFERENCE_NUMBER" :disabled="list.ID != ''" type="text" name="" id="edt-reference-number" class="edt-reference-number">
                                                            </td>
                                                                <td>
                                                                <input style="font-size: 9pt"  type="text" min="1" class="edt-reference-information" v-model="list.REFERENCE_INFORMATION">
                                                            </td>
                                                            <td>
                                                                <input style="font-size: 9pt"  type="number" min="1" class="edt-reference-men" v-model="list.MEN">
                                                            </td>
                                                            <td>
                                                                <input style="font-size: 9pt"  type="number" min="1" class="edt-reference-mh" v-model="list.MH">
                                                            </td>
                                                            <td align="center">
                                                                <div class="action">
                                                                    <i v-if="list.ID !== ''" v-on:click="postReference(index, 'update')" class="material-icons success edit-ref">edit</i>
                                                                    <i v-else v-on:click="postReference(index, 'insert')" class="material-icons success edit-ref">edit</i>
                                                                    <i v-on:click="removeRowReference(index, list.ID)" class="material-icons danger delete-user btn-ref-delete">delete</i>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                     </div>
                                 </div>
                            </div>

                            <!-- panel material ref editor -->
                            <!-- <div id="material-ref" v-if="editor.material_ref.isShow">
                                <div class="is-row">
                                    <div class="is-col is-30">
                                        <div class="card">
                                            <div class="card-header no-border">
                                                Master Part
                                            </div>
                                            <div class="card-content"
                                                style="box-sizing: border-box; height: 295px; overflow:hidden">
                                                <template>
                                                    <div>
                                                        <vue-good-table :columns="editor.material_ref.field"
                                                            :rows="editor.material.part" max-height="215px"
                                                            styleClass="vgt-table bordered striped" :search-options="{
                                                            enabled: true,
                                                            trigger: 'keyup',
                                                            skipDiacritics: true,
                                                            placeholder: 'Fill to search'
                                                        }" :pagination-options="{
                                                            enabled: true,
                                                            mode: 'records',
                                                            perPage: 10,
                                                            position: 'bottom',
                                                            perPageDropdown: editor.perPage,
                                                            dropdownAllowAll: true,
                                                            setCurrentPage: 1,
                                                            nextLabel: '',
                                                            prevLabel: '',
                                                            rowsPerPageLabel: '',
                                                            ofLabel: 'of',
                                                            pageLabel: '', // for 'pages' mode
                                                            allLabel: 'All',
                                                        }">
                                                        </vue-good-table>

                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="is-col is-70">
                                        <div class="card">
                                            <div class="card-header no-border">
                                                <div class="title-area">
                                                    Detail Reference Task Material
                                                </div>
                                                <div class="option-box">
                                                    <div class="option-item">
                                                        <button class="btn-add btn-add-row"
                                                            v-on:click="addRowMaterialRef(editor.material_ref.detail_material_ref.length+1)">
                                                            <i class="material-icons">add</i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-content is-table-fixed is-table-fixed-material" style="box-sizing: border-box; height: 285px; overflow:hidden">
                                                <table style="font-size: 9pt;" class="is-striped is-bordered"
                                                    id="table-zone">
                                                    <thead>
                                                        <tr>
                                                            <th style="text-align: center;" width="35%">Ref Information</th>
                                                            <th width="35%" style="text-align: center;">Part Number</th>
                                                            <th style="text-align: center;" width="12%">QTY</th>
                                                            <th style="text-align: center;" width="18%">Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="(list, index) in editor.material_ref.detail_material_ref"
                                                            :key="list.IDX">
                                                            <td>
                                                                <input type="hidden" class="edt-material-ref-id" v-bind:value="list.ID">
                                                                <select style="font-size: 9pt" :disabled="list.ID !== ''" id="edt-material-ref" class="edt-material-ref">
                                                                    <option v-for="ref in editor.reference.detail_reference" :selected="ref.REFERENCE_INFORMATION == list.REFERENCE_INFORMATION" :key="ref.IDX" v-bind:value="ref.ID"> {{ ref.REFERENCE_INFORMATION}}</option>
                                                                </select>
                                                            </td>
                                                            <td>
                                                                <select style="font-size: 9pt" :disabled="list.ID !== ''" id="edt-material-ref-part" class="edt-material-ref-part">
                                                                    <option v-for="part in editor.material.part" :selected="part.PART_NUMBER == list.PART_NUMBER" :key="part.ID" v-bind:value="part.ID">{{ part.PART_NUMBER}}</option>
                                                                </select>
                                                            </td>
                                                            <td>
                                                                <input style="font-size: 9pt" type="number" min="1" class="edt-material-ref-qty" v-bind:value="list.QTY">
                                                            </td>
                                                            <td align="center">
                                                                <div class="action">
                                                                    <i v-if="list.QTY !== ''"
                                                                        v-on:click="postMaterialRef(index, 'update')"
                                                                        class="material-icons success edit-user">edit</i>
                                                                    <i v-else
                                                                        v-on:click="postMaterialRef(index, 'insert')"
                                                                        class="material-icons success edit-user">edit</i>
                                                                    <i v-on:click="removeRowMaterialRef(index, list.ID)"
                                                                        class="material-icons danger delete-user btn-core-delete">delete</i>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div> -->

                        </div>
                        <div class="modal-footer" style="">
                            <button class="button is-primary is-default cancel" v-on:click="hideModal('modal-editor')">Close</button>

                        </div>
                    <!-- </form> -->
                </div>
            </div>
            <!-- /Modal editor -->

            <!-- Modal view detail -->
            <div class="modal-box" id="modal-detail-mpd" style="margin-top: -15px">
                <div class="modal lg">
                    <span class="close" v-on:click="hideModal('modal-detail-mpd')"></span>
                        <div class="modal-header">
                            <h2 class="title">Detail MPD</h2>
                        </div>
                        <div class="modal-body" style="position: relative; min-height: 150px; max-height: 450px; overflow: auto;">
                            <loading
                                :active.sync="loading.isLoadingDetailMPD" 
                                :can-cancel="false"
                                :is-full-page="false"
                                :color="loading.color"
                                :loader="loading.loaderType">
                            </loading>

                            <div v-if="editor.isDetailMPDShow">
                                <div class="is-table-container">
                                    <table class="is-striped is-bordered">
                                        <thead>
                                            <tr>
                                                <th nowrap>MPD Number</th>
                                                <th nowrap>Rev Code</th>
                                                <th nowrap>Section</th>
                                                <th nowrap>Skill Code</th>
                                                <th nowrap>Task Code</th>
                                                <th nowrap>Sample Threshold</th>
                                                <th nowrap>Sample Interval</th>
                                                <th nowrap>100% Threshold</th>
                                                <th nowrap>100% Interval</th>
                                                <th nowrap>TCI</th>
                                                <th nowrap>TPS</th>
                                                <th nowrap>PMPS</th>
                                                <th nowrap>Reference</th>
                                                <th nowrap>Applicability</th>
                                                <th nowrap>Qual</th>
                                                <th nowrap>Remarks</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr v-for="list in detail_mpd" :key="list.ID">
                                                <td nowrap>{{list.TASK_NUMBER}}</td>
                                                <td nowrap>{{list.REV_CODE}}</td>
                                                <td nowrap>{{list.SECTION}}</td>
                                                <td nowrap>{{list.SKILL_CODE}}</td>
                                                <td nowrap>{{list.TASK_CODE}}</td>
                                                <td nowrap>{{list.SAMPLE_THRESHOLD}}</td>
                                                <td nowrap>{{list.SAMPLE_INTERVAL}}</td>
                                                <td nowrap>{{list.FULL_THRESHOLD}}</td>
                                                <td nowrap>{{list.FULL_INTERVAL}}</td>
                                                <td nowrap>{{list.TCI}}</td>
                                                <td nowrap>{{list.TPS}}</td>
                                                <td nowrap>{{list.PMPS}}</td>
                                                <td nowrap>{{list.REFERENCE}}</td>
                                                <td nowrap>{{list.APLICABILITY}}</td>
                                                <td nowrap>{{list.QUAL}}</td>
                                                <td nowrap>{{list.REMARKS}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div style="padding-bottom:10px;">
                                    <div class="card">
                                        <h5>Description</h5>
                                        <span v-html="list.DESCRIPTION" style="font-size: 9pt;" v-for="list in detail_mpd" :key="list.ID">
                                        </span>
                                    </div>
                                </div>

                                <!-- Core and access -->
                                <div>
                                    <div class="is-row">
                                        <div class="is-col is-30">
                                            <div class="card" style="height: 352px;">
                                                <h5>Core Task</h5>
                                                <template>
                                                    <div>
                                                        <vue-good-table
                                                            :columns="editor.core.detail_fields"
                                                            :rows="editor.core.detail_zone"
                                                            max-height="215px"
                                                            styleClass="vgt-table bordered striped"
                                                            
                                                            :search-options="{
                                                                enabled: true,
                                                                trigger: 'keyup',
                                                                skipDiacritics: true,
                                                                placeholder: 'Fill to search'
                                                            }"
                                                            :pagination-options="{
                                                                enabled: true,
                                                                mode: 'records',
                                                                perPage: 10,
                                                                position: 'bottom',
                                                                perPageDropdown: editor.perPage,
                                                                dropdownAllowAll: true,
                                                                setCurrentPage: 1,
                                                                nextLabel: '',
                                                                prevLabel: '',
                                                                rowsPerPageLabel: '',
                                                                ofLabel: 'of',
                                                                pageLabel: '', // for 'pages' mode
                                                                allLabel: 'All',
                                                            }"
                                                        >
                                                        </vue-good-table>

                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                        <div class="is-col is-70">
                                            <div class="card" style="height: 352px;">
                                                <h5>Access</h5>
                                                <template>
                                                    <div>
                                                        <vue-good-table
                                                            :columns="editor.access.detail_fields"
                                                            :rows="editor.access.detail_access"
                                                            max-height="215px"
                                                            styleClass="vgt-table bordered striped"
                                                            
                                                            :search-options="{
                                                                enabled: true,
                                                                trigger: 'keyup',
                                                                skipDiacritics: true,
                                                                placeholder: 'Fill to search'
                                                            }"
                                                            :pagination-options="{
                                                                enabled: true,
                                                                mode: 'records',
                                                                perPage: 10,
                                                                position: 'bottom',
                                                                perPageDropdown: editor.perPage,
                                                                dropdownAllowAll: true,
                                                                setCurrentPage: 1,
                                                                nextLabel: '',
                                                                prevLabel: '',
                                                                rowsPerPageLabel: '',
                                                                ofLabel: 'of',
                                                                pageLabel: '', // for 'pages' mode
                                                                allLabel: 'All',
                                                            }"
                                                        >
                                                        </vue-good-table>

                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- material -->
                                <div style="padding-bottom:10px;">
                                    <div class="card">
                                        <h5>Material & Tools</h5>

                                        <template>
                                            <div>
                                                <vue-good-table
                                                    :columns="editor.material.detail_fields"
                                                    :rows="editor.material.detail_material"
                                                    max-height="215px"
                                                    styleClass="vgt-table bordered striped"
                                                    
                                                    :search-options="{
                                                        enabled: true,
                                                        trigger: 'keyup',
                                                        skipDiacritics: true,
                                                        placeholder: 'Fill to search'
                                                    }"
                                                    :pagination-options="{
                                                        enabled: true,
                                                        mode: 'records',
                                                        perPage: 10,
                                                        position: 'bottom',
                                                        perPageDropdown: editor.perPage,
                                                        dropdownAllowAll: true,
                                                        setCurrentPage: 1,
                                                        nextLabel: '',
                                                        prevLabel: '',
                                                        rowsPerPageLabel: '',
                                                        ofLabel: 'of',
                                                        pageLabel: '', // for 'pages' mode
                                                        allLabel: 'All',
                                                    }"
                                                >
                                                </vue-good-table>

                                            </div>
                                        </template>

                                    </div>
                                </div>

                                <!-- preparation -->
                                <div style="padding-bottom:10px;">
                                    <div class="card">
                                        <h5>Preparation</h5>

                                        <template>
                                            <div>
                                                <vue-good-table
                                                    :columns="editor.preparation.detail_fields"
                                                    :rows="editor.preparation.detail_preparation"
                                                    max-height="215px"
                                                    styleClass="vgt-table bordered striped"
                                                    
                                                    :search-options="{
                                                        enabled: true,
                                                        trigger: 'keyup',
                                                        skipDiacritics: true,
                                                        placeholder: 'Fill to search'
                                                    }"
                                                    :pagination-options="{
                                                        enabled: true,
                                                        mode: 'records',
                                                        perPage: 10,
                                                        position: 'bottom',
                                                        perPageDropdown: editor.perPage,
                                                        dropdownAllowAll: true,
                                                        setCurrentPage: 1,
                                                        nextLabel: '',
                                                        prevLabel: '',
                                                        rowsPerPageLabel: '',
                                                        ofLabel: 'of',
                                                        pageLabel: '', // for 'pages' mode
                                                        allLabel: 'All',
                                                    }"
                                                >
                                                </vue-good-table>

                                            </div>
                                        </template>
                                    </div>
                                </div>

                                <!-- REFERENCE -->
                                <div class="card">
                                    <h5> Reference </h5>
                                    <template>
                                        <div>
                                            <vue-good-table
                                                :columns="editor.reference.detail_fields"
                                                :rows="editor.reference.detail_reference"
                                                max-height="215px"
                                                styleClass="vgt-table bordered striped"
                                                
                                                :search-options="{
                                                    enabled: true,
                                                    trigger: 'keyup',
                                                    skipDiacritics: true,
                                                    placeholder: 'Fill to search'
                                                }"
                                                :pagination-options="{
                                                    enabled: true,
                                                    mode: 'records',
                                                    perPage: 10,
                                                    position: 'bottom',
                                                    perPageDropdown: editor.perPage,
                                                    dropdownAllowAll: true,
                                                    setCurrentPage: 1,
                                                    nextLabel: '',
                                                    prevLabel: '',
                                                    rowsPerPageLabel: '',
                                                    ofLabel: 'of',
                                                    pageLabel: '', // for 'pages' mode
                                                    allLabel: 'All',
                                                }"
                                            >
                                            </vue-good-table>

                                        </div>
                                    </template>
                                </div>
                            </div>


                        </div>
                        <div class="modal-footer" style="">
                            <button class="button is-primary is-default cancel" v-on:click="hideModal('modal-detail-mpd')">Close</button>
                        </div>
                </div>
            </div>
            <!-- /Modal view detail -->

            <!-- Modal add revision -->
            <div class="modal-box" id="modal-add-revision">
                <div class="modal sm">
                    <span class="close" v-on:click="hideModal('modal-add-revision')"></span>
                        <div class="modal-header">
                            <h2 class="title">Add Revision</h2>
                        </div>
                        <div class="modal-body" style="position: relative">
                            <div class="form-item">
                                <label>Revision Name <span class="is-req">*</span></label>
                                <input v-model="form_revision.revision_name" type="text">
                            </div>
                             <div class="form-item">
                                <label>Description <span class="is-req">*</span> <span class="is-desc"></span></label>
                                <textarea v-model="form_revision.revision_desc" placeholder=""  name="" id="" cols="30" rows="5"></textarea>
                            </div>
                            <div class="form-item">
                                <label>Revision File <span class="is-req">* </span></label>
                                <input type="file" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" id="revision-file"  ref="revision_file" v-on:change="onChangeFileUpload()">
                                <span class="is-desc">Allowed extension .xlsx</span>
                            </div>
                            <div class="form-item">
                                <i style="font-size: 11pt;" class='material-icons'>
                                    attach_file
                                </i>
                                <a href="/export/template_mpd.xlsx">Download Template</a>
                            </div>
                        </div>
                        <div class="modal-footer" style="">
                            <button class="button is-primary is-default cancel" v-on:click="hideModal('modal-add-revision')">Close</button>
                            <button v-on:click="addRevision()" class="button" type="button" id="btn-add-revision">Save</button>
                        </div>
                </div>
            </div>
            <!-- /Modal add revision -->

            <!-- modal select -->
            <div class="modal-box" id="modal-select-data">
                <div class="modal sm">
                    <span class="close" v-on:click="hideModal('modal-select-data')"></span>
                        <div class="modal-header">
                            <h2 class="title">Add <span id="modal-select-title"></span></h2>
                        </div>
                        <div class="modal-body" style="position: relative">
                            <label>Select <span id="modal-select-label-title"></span></label>
                            <multiselect 
                                v-model="m_select.selected" 
                                :label="m_select.label"
                                :track-by="m_select.label"
                                placeholder="Type at least 1 characters to find data" 
                                open-direction="bottom" 
                                :options="m_select.items"

                                :multiple="false"
                                :searchable="true" 
                                :loading="m_select.loading" 
                                :internal-search="false" 
                                :clear-on-select="true" 
                                :close-on-select="true" 
                                :options-limit="300" 
                                :limit="5" 
                                :limit-text="limitText" 
                                :max-height="600" 
                                :show-no-results="false" 
                                :hide-selected="true" 
                                @search-change="handelrSelectData($event)"
                                >
                            </multiselect>
                        </div>
                        <div class="modal-footer" style="">
                            <button class="button is-primary is-default cancel" v-on:click="hideModal('modal-select-data')">Close</button>
                            <button v-on:click="handlerAddSelect()" class="button is-success" type="submit" id="btn-add-data"> Add </button>
                        </div>
                    <!-- </form> -->
                </div>
            </div>
            <!-- / modal select -->

            <!-- modal select add -->
            <div class="modal-box" id="modal-select-data-add">
                <div class="modal sm">
                    <span class="close" v-on:click="hideModal('modal-select-data-add')"></span>
                        <div class="modal-header">
                            <h2 class="title">Add <span id="modal-select-title-add"></span></h2>
                        </div>
                        <div class="modal-body" style="position: relative">
                            <label>Select <span id="modal-select-label-title-add"></span></label>
                            <multiselect 
                                v-model="m_add.selected" 
                                :label="m_add.label"
                                :track-by="m_add.label"
                                placeholder="Type at least 1 characters to find data" 
                                open-direction="bottom" 
                                :options="m_add.items"

                                :multiple="false"
                                :searchable="true" 
                                :loading="m_add.loading" 
                                :internal-search="false" 
                                :clear-on-select="true" 
                                :close-on-select="true" 
                                :options-limit="300" 
                                :limit="5" 
                                :limit-text="limitText" 
                                :max-height="600" 
                                :show-no-results="false" 
                                :hide-selected="true" 
                                @search-change="handelrSelectDataAdd($event)"
                                >
                            </multiselect>
                        </div>
                        <div class="modal-footer" style="">
                            <button class="button is-primary is-default cancel" v-on:click="hideModal('modal-select-data-add')">Close</button>
                            <button v-on:click="handlerAddSelectMPD()" class="button is-success" type="submit" id="btn-add-data-mpd"> Add </button>
                        </div>
                    <!-- </form> -->
                </div>
            </div>
            <!-- /modal select add -->

            <!-- modal master data -->
            <div class="modal-box" id="modal-master-data" style="margin-top: -20px;">
                <div class="modal lg">
                    <span class="close" v-on:click="hideModal('modal-master-data')"></span>
                        <div class="modal-header">
                            <h2 class="title">Master Data</h2>
                        </div>
                        <div class="modal-body modal-master-data" style="position: relative">
                            <div class="option-box">
                                <div class="option-item">
                                    <span style="white-space: nowrap">Master Type</span>
                                    <select v-model="master_type" id="master-type">
                                        <option value="" disabled selected>Master Type</option>
                                        <option value="master_zone">Master Zone</option>
                                        <option value="master_access">Master Access</option>
                                        <option value="master_preparation">Master Preparation</option>
                                        <option value="master_part">Master Part</option>
                                    </select>
                                </div>
                                <div class="option-item">
                                    <button style="width: 140px;" v-on:click="handlerOpenMaster()">
                                        <i class="material-icons">folder</i>
                                        Open
                                    </button>
                                </div>
                            </div>
                            <hr style="padding: 15px 0px 0px 0px; margin-right: -15px; margin-left: -15px;">
                            <loading style="margin-top: 50px;"
                                :active.sync="loading.isLoadingMaster" 
                                :can-cancel="false"
                                :is-full-page="false"
                                :color="loading.color"
                                :loader="loading.loaderType">
                            </loading>
                            <!-- master zone -->
                            <div v-if="master.zone.is_show">
                                <template>
                                    <div class="feedback">
                                        <vue-good-table
                                            ref="tableMasterZone"
                                            :columns="master.zone.field"
                                            :rows="master.zone.rows"  
                                            styleClass="vgt-table bordered striped"
                                            mode="remote"
                                            max-height="460px"
                                            :search-options="{
                                                enabled: true,
                                                trigger: 'enter',
                                                skipDiacritics: true,
                                                placeholder: 'Fill and enter to search',
                                                
                                            }"
                                            :line-numbers="true"
                                            :select-options="{ 
                                                enabled: false,
                                                selectOnCheckboxOnly: true
                                            }"
                                            @on-search="onColumnSearchMZone"
                                            @on-page-change="onPageChangeMZone"
                                            @on-sort-change="onSortChangeMZone"
                                            @on-column-filter="onColumnFilterMZone"
                                            @on-per-page-change="onPerPageChangeMZone"
                                            :totalRows="master.zone.totalRows"
                                            :pagination-options="{
                                                enabled: true,
                                                mode: 'pages',
                                                perPage: master.zone.serverParams.perPage,
                                                position: 'bottom',
                                                perPageDropdown:  master.zone.perPageDropDown,
                                                dropdownAllowAll: true,
                                                setCurrentPage: master.zone.serverParams.page,
                                                nextLabel: 'Next',
                                                prevLabel: 'Prev',
                                                rowsPerPageLabel: 'Rows per page',
                                                ofLabel: 'of',
                                                pageLabel: 'page', // for 'pages' mode
                                                allLabel: 'All',
                                            }"
                                        >
                                        <div slot="table-actions">
                                            <div class="toolbar toolbar-default">
                                                <div class="toolbar-left">
                                                    <button v-on:click="handlerModalMasterZone('Add', '')">Add New</button>
                                                </div>
                                            </div>
                                        </div>
                                        <template slot="table-row" slot-scope="props">
                                            <span v-if="props.column.field == 'ACTION'">
                                                <div class="action">
                                                    <i v-on:click="handlerModalMasterZone('Update', props.index)" class="material-icons success edit-user">edit</i> 
                                                    <i v-on:click="handlerRemoveMasterZone(props.formattedRow['ID'])" class="material-icons danger delete-user">delete</i>
                                                </div>
                                            </span>
                                        </template>
                                        </vue-good-table>
                                    </div>
                                </template>
                            </div>
                            <div v-show="master.access.is_show">
                                <template>
                                    <div class="feedback">
                                        <vue-good-table
                                            ref="tableMasterAccess"
                                            :columns="master.access.field"
                                            :rows="master.access.rows"  
                                            styleClass="vgt-table bordered striped"
                                            mode="remote"
                                            max-height="460px"
                                            :search-options="{
                                                enabled: true,
                                                trigger: 'enter',
                                                skipDiacritics: true,
                                                placeholder: 'Fill and enter to search',
                                                
                                            }"
                                            :line-numbers="true"
                                            :select-options="{ 
                                                enabled: false,
                                                selectOnCheckboxOnly: true
                                            }"
                                            @on-search="onColumnSearchMAccess"
                                            @on-page-change="onPageChangeMAccess"
                                            @on-sort-change="onSortChangeMAccess"
                                            @on-column-filter="onColumnFilterMAccess"
                                            @on-per-page-change="onPerPageChangeMAccess"
                                            :totalRows="master.access.totalRows"
                                            :pagination-options="{
                                                enabled: true,
                                                mode: 'pages',
                                                perPage: master.access.serverParams.perPage,
                                                position: 'bottom',
                                                perPageDropdown:  master.access.perPageDropDown,
                                                dropdownAllowAll: true,
                                                setCurrentPage: master.access.serverParams.page,
                                                nextLabel: 'Next',
                                                prevLabel: 'Prev',
                                                rowsPerPageLabel: 'Rows per page',
                                                ofLabel: 'of',
                                                pageLabel: 'page', // for 'pages' mode
                                                allLabel: 'All',
                                            }"
                                        >
                                        <div slot="table-actions">
                                            <div class="toolbar toolbar-default">
                                                <div class="toolbar-left">
                                                    <button v-on:click="handlerModalMasterAccess('Add', '')">Add New</button>
                                                </div>
                                            </div>
                                        </div>
                                        <template slot="table-row" slot-scope="props">
                                            <span v-if="props.column.field == 'ACTION'">
                                                <div class="action">
                                                    <i v-on:click="handlerModalMasterAccess('Update', props.index)" class="material-icons success edit-user">edit</i> 
                                                    <i v-on:click="handlerRemoveMasterAccess(props.formattedRow['ID'])" class="material-icons danger delete-user">delete</i>
                                                </div>
                                            </span>
                                            <span v-else-if="props.column.field == 'ACCESS'">
                                                {{props.formattedRow[props.column.field]}}
                                            </span>
                                            <span v-else-if="props.column.field == 'DESCRIPTION'">
                                                {{props.formattedRow[props.column.field]}}
                                            </span>
                                            <span v-else>
                                                <div style="width: 100%; text-align: center;">
                                                    {{props.formattedRow[props.column.field]}}
                                                </div>
                                            </span>
                                        </template>
                                        </vue-good-table>
                                    </div>
                                </template>
                            </div>
                            <!-- /master access -->

                            <!-- mater preparation -->
                            <div v-if="master.preparation.is_show">
                                <template>
                                    <div class="feedback">
                                        <vue-good-table
                                            ref="tableMasterZone"
                                            :columns="master.preparation.field"
                                            :rows="master.preparation.rows"  
                                            styleClass="vgt-table bordered striped"
                                            mode="remote"
                                            max-height="460px"
                                            :search-options="{
                                                enabled: true,
                                                trigger: 'enter',
                                                skipDiacritics: true,
                                                placeholder: 'Fill and enter to search',
                                                
                                            }"
                                            :line-numbers="true"
                                            :select-options="{ 
                                                enabled: false,
                                                selectOnCheckboxOnly: true
                                            }"
                                            @on-search="onColumnSearchMPrep"
                                            @on-page-change="onPageChangeMPrep"
                                            @on-sort-change="onSortChangeMPrep"
                                            @on-column-filter="onColumnFilterMPrep"
                                            @on-per-page-change="onPerPageChangeMPrep"
                                            :totalRows="master.preparation.totalRows"
                                            :pagination-options="{
                                                enabled: true,
                                                mode: 'pages',
                                                perPage: master.preparation.serverParams.perPage,
                                                position: 'bottom',
                                                perPageDropdown:  master.preparation.perPageDropDown,
                                                dropdownAllowAll: true,
                                                setCurrentPage: master.preparation.serverParams.page,
                                                nextLabel: 'Next',
                                                prevLabel: 'Prev',
                                                rowsPerPageLabel: 'Rows per page',
                                                ofLabel: 'of',
                                                pageLabel: 'page', // for 'pages' mode
                                                allLabel: 'All',
                                            }"
                                        >
                                        <div slot="table-actions">
                                            <div class="toolbar toolbar-default">
                                                <div class="toolbar-left">
                                                    <button v-on:click="handlerModalMasterPreparation('Add', '')">Add New</button>
                                                </div>
                                            </div>
                                        </div>
                                        <template slot="table-row" slot-scope="props">
                                            <span v-if="props.column.field == 'ACTION'">
                                                <div class="action">
                                                    <i v-on:click="handlerModalMasterPreparation('Update', props.index)" class="material-icons success edit-user">edit</i> 
                                                    <i v-on:click="handlerRemoveMasterPreparation(props.formattedRow['ID'])" class="material-icons danger delete-user">delete</i>
                                                </div>
                                            </span>
                                        </template>
                                        </vue-good-table>
                                    </div>
                                </template>
                            </div>
                            <!-- /master preparation -->

                        </div>
                        <div class="modal-footer" style="">
                            <button class="button is-primary is-default cancel" v-on:click="hideModal('modal-master-data')">Close</button>
                        </div>
                    <!-- </form> -->
                </div>
            </div>
            <!-- /modal master data -->

            <!-- modal master zone -->
                <div class="modal-box" id="modal-master-zone">
                    <div class="modal sm">
                        <span class="close" v-on:click="hideModal('modal-master-zone')"></span>
                            <div class="modal-header">
                                <h2 class="title"><span id="status-post-zone"></span> Zone</h2>
                            </div>
                            <div class="modal-body" style="position: relative">
                                <div class="form-item">
                                    <label for="">Zone</label>
                                    <input type="hidden" v-model="master.zone.form.ID">
                                    <input type="text" v-model="master.zone.form.ZONE" placeholder="Zone">
                                </div>
                            </div>
                            <div class="modal-footer" style="">
                                <button class="button is-primary is-default cancel" v-on:click="hideModal('modal-master-zone')">Close</button>
                                <button class="button is-success" v-on:click="handlerPostMasterZone()" type="submit" id="btn-save-master-zone">Save</button>

                            </div>
                    </div>
                </div>
            <!-- / modal master zone -->

            <!-- modal master access -->
            <div class="modal-box" id="modal-master-access">
                <div class="modal sm">
                    <span class="close" v-on:click="hideModal('modal-master-access')"></span>
                        <div class="modal-header">
                            <h2 class="title"><span id="status-post-access"></span> Access</h2>
                        </div>
                        <div class="modal-body" style="position: relative">
                            <div class="form-item">
                                <label for="">Access</label>
                                <input type="hidden" v-model="master.access.form.ID">
                                <input type="text" v-model="master.access.form.ACCESS" placeholder="Access">
                            </div>
                            <div class="form-item">
                                <label for="">Description</label>
                                <input type="text" v-model="master.access.form.DESCRIPTION" placeholder="Desciption">
                            </div>
                            <div class="form-item">
                                <label> Access data <span  class="is-req">*</span></label>
                                <div class="is-row">
                                    <div class="form-item is-col is-25">
                                        <input  v-model="master.access.form.MEN" type="number"> 
                                        <div class="is-desc">Men Remove</div>
                                    </div> 
                                    <div class="form-item is-col is-25">
                                        <input  v-model="master.access.form.MH" type="number"> 
                                        <div class="is-desc">Mhrs Remove</div>
                                    </div>
                                    <div class="form-item is-col is-25">
                                        <input  v-model="master.access.form.MEN_INSTALL" type="number"> 
                                        <div class="is-desc">Men Install</div>
                                    </div> 
                                    <div class="form-item is-col is-25">
                                        <input  v-model="master.access.form.MH_INSTALL" type="number"> 
                                        <div class="is-desc">Mhrs Install</div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-item">
                                <label for="">A/C Type</label>
                                <select id="aircraft-type"  v-model="master.access.form.AIRCRAFT">
                                    <option value="" disabled selected>A/C Type</option>
                                    <option v-for="aircraft in aircrafts" :key="aircraft.ID" v-bind:value="aircraft.AIRCRAFT">{{ aircraft.AIRCRAFT }}</option>
                                </select>
                            </div>
                        </div>
                        <div class="modal-footer" style="">
                            <button class="button is-primary is-default cancel" v-on:click="hideModal('modal-master-access')">Close</button>
                            <button class="button is-success" v-on:click="handlerPostMasterAccess()" type="submit" id="btn-save-master-access">Save</button>

                        </div>
                </div>
            </div>
            <!-- /modal master access -->

            <!-- modal master preparation -->
            <div class="modal-box" id="modal-master-preparation">
                <div class="modal sm">
                    <span class="close" v-on:click="hideModal('modal-master-preparation')"></span>
                        <div class="modal-header">
                            <h2 class="title"><span id="status-post-preparation"></span> Preparation</h2>
                        </div>
                        <div class="modal-body" style="position: relative">
                            <div class="form-item">
                                <label for="">Preparation</label>
                                <input type="hidden" v-model="master.preparation.form.ID">
                                <input type="text" v-model="master.preparation.form.PREPARATION" placeholder="Preparation">
                            </div>
                        </div>
                        <div class="modal-footer" style="">
                            <button class="button is-primary is-default cancel" v-on:click="hideModal('modal-master-preparation')">Close</button>
                            <button class="button is-success" v-on:click="handlerPostMasterPreparation()" type="submit" id="btn-save-master-preparation">Save</button>

                        </div>
                </div>
            </div>
            <!-- /modal master preparation -->

        </div>
    </div>
</template>

<script>

import Loading from 'vue-loading-overlay'
import axios from 'axios'
import 'vue-loading-overlay/dist/vue-loading.css'
import XLSX from 'xlsx'
import Multiselect from 'vue-multiselect'


import FieldRevision from "./datatable/FieldRevision.js";
import FieldZone from "./datatable/FieldZone.js";
import FieldPreparation from "./datatable/FieldPreparation.js";
import FieldMaterial from "./datatable/FieldMaterial.js";
import FieldAccess from "./datatable/FieldAccess.js";
import 'vue-multiselect/dist/vue-multiselect.min.css'

//vue-good
import 'vue-good-table/dist/vue-good-table.css'
import { VueGoodTable } from 'vue-good-table'

// field detail
import FieldDetailZone from "../datatable/FieldZone";
import FieldDetailAccess from "../datatable/FieldAccess";
import FieldDetailMaterial from "../datatable/FieldMaterial";
import FieldDetailPreparation from "../datatable/FieldPreparation";
import FieldDetailReference from "../datatable/FieldReference";

// field master
import FieldMasterZone from "./datatable/FieldMasterZone";
import FieldMasterAccess from "./datatable/FieldMasterAccess";
import FieldMasterPreparation from "./datatable/FieldMasterPreparation";


export default {
    components: {
        Loading,
        VueGoodTable,
        'multiselect': Multiselect
    },

    computed: {
        user() {
            return JSON.parse(localStorage.getItem('user'))
        },

         filterZone: function() {
            return this.add.zone.rows.filter(d => d.zone !== "");
        }, 
        
        filterPrep: function() {
            return this.add.preparation.rows.filter(d => d.preparation !== "");
        }, 
        
        // filterRef: function() {
        //     return this.add.reference.rows.filter(d => d.reference_information !== "");
        // },

        filterPart: function() {
            return this.add.part.rows.filter(d => d.part_number !== "");
        }
    },

    data: () => ({
        aircrafts: [],
        form: {
            id_aircraft: ''
        },
        form_editor: {
            aircraft_type: '',
            mpd_number: '',
            id_revision: '',
        },
        form_revision: {
            revision_name: '',
            revision_desc: '',
            revision_file: '',
        },
        loading: {
            isLoading: false,
            isLoadingAddMPD: false,
            isLoadingDetailMPD: false,
            isDetailLoading: false,
            isLoadingEditor: false,
            isLoadingMaster: false,
            isLoadingClone: false,
            fullPage: false,
            loaderType: 'dots',
            color: '#0065ff',
        },
        detail_revision: {
            serverParams: {
                columnFilters: {
                },
                sort: {
                    type: 'asc',
                    field: 'TASK_NUMBER'
                },
                page: 1, 
                perPage: 10,
                searchTerm: '',
                filter: {

                },
                id_revision: '',
                id_aircraft: ''
            },
            fields: FieldRevision,
            rows: [],
            totalRows: '',
            perPageDropDown: [10, 50, 100],
        },
        editor: {
            core: {
                isShow: false,
                zone: [],
                detail_zone:[],
                field: FieldZone,
                detail_fields: FieldDetailZone,
            },
            preparation: {
                isShow: false,
                preparation: [],
                detail_preparation: [],
                field: FieldPreparation,
                detail_fields: FieldDetailPreparation,
                detail_rows: []
            },
            material: {
                isShow: false,
                part: [],
                detail_material: [],
                field: FieldMaterial,
                detail_fields: FieldDetailMaterial,
            },
            core_material: {
                isShow: false,
                part: [],
                detail_core_material: [],
                field: FieldMaterial,
                detail_fields: FieldDetailMaterial,
            },
            material_prep: {
                isShow: false,
                part: [],
                detail_material_prep: [],
                field: FieldMaterial,
                detail_fields: FieldDetailMaterial,
            },
            access: {
                isShow: false,
                access: [],
                detail_access: [],
                detail_zone: [],
                field: FieldAccess,
                detail_fields: FieldDetailAccess,
            },

            reference: {
                isShow: false,
                reference: [],
                detail_reference: [],
                field: FieldPreparation,
                detail_fields: FieldDetailReference,
                detail_rows: []
            },

            // material_ref: {
            //     isShow: false,
            //     part: [],
            //     detail_material_ref: [],
            //     field: FieldMaterial,
            //     detail_fields: FieldDetailMaterial,
            // },

            perPage: [10, 50, 100],
            isDetailMPDShow: false,
            id_aircraft: '',

        },
        add: {
            task: {
                rev_code: '',
                section: '',
                mpd_number: '',
                source_task_reference: '',
                skill_code: '',
                task_code: '',
                sample_threshold: '',
                sample_interval: '',
                full_threshold: '',
                full_interval: '',
                source: '',
                tci: '',
                tps: '',
                pmps: '',
                reference: '',
                applicability: '',
                description: '',
                qual: '',
                remarks: ''
            },

            zone: {
                rows: []
            },
            access: {
                rows: [],
            },
            preparation: {
                rows: [],
            },

            reference: {
                rows: [],
            },
            part: {
                rows: [],
            },
            preppart: {
                rows: [],
            },
            refpart: {
                rows: []
            },
            material: {
                rows: []
            }
        },

        revisions: [],
        isRevisionShow: false,
        isDetailRevisionShow: false,
        isAddMPDShow: false,
        message: 'Select Aircraft Type then click the Search button !',
        editor_type: '',
        detail_task: '',
        id_revision: '',
        id_aircraft: '',
        detail_mpd: [],
        m_select: {
            selected: [],
            items: [],
            loading: false,
            label: "",
            classesid: "",
            classesname: "",
            index: "",
            api: "",
            attr_hide: "",
            attr_show: "",
        },

        m_add: {
            selected: [],
            items: [],
            loading: false,
            label: "",
            classesid: "",
            index: "",
            api: "",
            attr_show: "",
        },
        master_type: '',
        master: {
            zone: {
                is_show: false,
                field: FieldMasterZone,
                rows: [],
                totalRows: '',
                serverParams: {
                    columnFilters: {
                    },
                    sort: {
                        type: '',
                        field: ''
                    },
                    page: 1, 
                    perPage: 10,
                    searchTerm: '',
                    filter: {}
                },
                perPageDropDown: [10, 50, 100],
                selectedRows: [],
                form: {
                    ID: "",
                    ZONE: "",
                }
            },
            access: {
                is_show: false,
                field: FieldMasterAccess,
                rows: [],
                totalRows: '',
                serverParams: {
                    columnFilters: {
                    },
                    sort: {
                        type: '',
                        field: ''
                    },
                    page: 1, 
                    perPage: 10,
                    searchTerm: '',
                    filter: {}
                },
                perPageDropDown: [10, 50, 100],
                selectedRows: [],
                form: {
                    ID: "",
                    ACCESS: "",
                    DESCRIPTION: "",
                    MEN: "",
                    MEN_INSTALL: "",
                    MH: "",
                    MH_INSTALL: "",
                    AIRCRAFT: "",
                }
            },
            preparation: {
                is_show: false,
                field: FieldMasterPreparation,
                rows: [],
                totalRows: '',
                serverParams: {
                    columnFilters: {
                    },
                    sort: {
                        type: '',
                        field: ''
                    },
                    page: 1, 
                    perPage: 10,
                    searchTerm: '',
                    filter: {}
                },
                perPageDropDown: [10, 50, 100],
                selectedRows: [],
                form: {
                    ID: "",
                    PREPARATION: "",
                }
            },
        }

    }),

    mounted() {
        this.initAircraft();
    },

    methods: {
        /**
         * Show Aircraft Type to select option whene page loaded
         */
        initAircraft: function() {
            axios.get('/api/aircraft/get_aircraft')
            .then( res => {
                this.aircrafts = res.data.data
            })
        },

        initZone: function() {
            return new Promise((resolve, reject) => {
                axios.get('/api/task/get_zone/' + this.id_revision)
                .then( res => {
                    this.editor.core.zone = res.data;
                    resolve();
                })  
            })
        }, 
        
        initDetailZone: function() {
            return new Promise((resolve, reject) => {
                axios.post('/api/task/get_detail_zone', this.form_editor)
                .then(res => {
                    this.editor.core.detail_zone = res.data;
                    resolve();
                })
            })
        },

        initPreparation: function() {
            return new Promise((resolve, result) => {
                axios.get('/api/task/get_preparation/' + this.id_revision)
                .then(res => {
                    this.editor.preparation.preparation = res.data;
                    resolve();  
                })
            })
        },
        

        initDetailPreparation: function() {
            return new Promise((resolve, reject) => {
                axios.post('/api/task/get_detail_preparation', this.form_editor)
                .then(res => {
                    this.editor.preparation.detail_preparation = res.data;
                    resolve();
                })
            })
        },

        initMaterial: function() {
            return new Promise((resolve, reject) => {
                axios.get('/api/task/get_material/' + this.id_revision)
                .then(res => {
                    this.editor.material.part = res.data;
                    resolve();
                })
            })
        },

        initDetailMaterial: function() {
            return new Promise((resolve, reject) => {
                axios.post('/api/task/get_detail_material', this.form_editor)
                .then(res => {
                    this.editor.material.detail_material = res.data;
                    resolve();
                })
            })
        },

        initDetailMaterialAll: function() {
            return new Promise((resolve, reject) => {
                axios.post('/api/task/get_detail_material_all', this.form_editor)
                .then(res => {
                    this.editor.material.detail_material = res.data;
                    resolve();
                })
            })
        },

        initDetailCoreMaterial: function() {
            return new Promise((resolve, reject) => {
                axios.post('/api/task/get_detail_material_core', this.form_editor)
                .then(res => {
                    this.editor.core_material.detail_core_material = res.data;
                    resolve();
                })
            })
        },

        initAccess: function() {
            return new Promise((resolve, reject) => {
                axios.post('/api/task/get_access_by_name', {
                    keyword: ""
                })
                .then(res => {
                    this.editor.access.access = res.data;
                    resolve();
                })
            })
        },

        initDetailAcessZone: function() {
            return new Promise((resolve, reject) => {
                axios.post('/api/task/get_detail_access_zone', this.form_editor)
                .then(res => {
                    this.editor.access.detail_zone = res.data;
                    resolve();
                })
            })
        },

        initDetailAccess: function() {
            return new Promise((resolve, reject) => {
                axios.post('/api/task/get_detail_access', this.form_editor)
                .then(res => {
                    this.editor.access.detail_access = res.data;
                    resolve();
                })
            })
        },

        initDetailPrepMaterial: function() {
            return new Promise((resolve, reject) => {
                axios.post('/api/task/get_detail_preparation_part', this.form_editor)
                .then(res => {
                    this.editor.material_prep.detail_material_prep = res.data;
                    resolve();
                })
            })
        },

        initDetailReference: function() {
            return new Promise((resolve, reject) => {
                axios.post('/api/task/get_detail_reference', this.form_editor)
                .then(res => {
                    this.editor.reference.detail_reference = res.data;
                    resolve();
                })
            })
        },

        // initDetailRefMaterial: function() {
        //     return new Promise((resolve, reject) => {
        //         axios.post('/api/task/get_detail_ref_part', this.form_editor)
        //         .then(res => {
        //             this.editor.material_ref.detail_material_ref = res.data;
        //             resolve();
        //         })
        //     })
        // },


        findRevision: function() {
            if(!this.handlerValidation()) {
                return;
            }
            this.loading.isLoading = true;
            this.isRevisionShow = false;
            this.isAddMPDShow = false;
            this.isDetailRevisionShow = false;
            axios.get('/api/revision/get_revision_by_aircraft/' + this.form.id_aircraft)
            .then(res => {
                if(res.data.success) {
                    this.revisions = res.data.data;
                    this.isRevisionShow = true;
                }else {
                    this.revisions = [];
                    // this.isRevisionShow = false;
                    this.isRevisionShow = true;
                    // this.message = 'Revision data not found in this aircraft type';
                }
                this.id_aircraft = this.form.id_aircraft;
                this.loading.isLoading = false;
            })
            .catch(e => {
                console.log("Error "+e);
                this.loading.isLoading = false;
                toastr.error("Undefined error")

            })
        },

        handlerValidation: function() {
            if(this.form.id_aircraft == "") {
                toastr.warning('Aircraft type cant be empty');
                return false;
            }
            return true;
        },

        handlerShowDetailRevision: function(id_revision, id_aircraft) {
            this.message = "";
            this.isRevisionShow = false;
            this.isAddMPDShow = false;
            this.isDetailRevisionShow = true;
            this.detail_revision.serverParams.id_aircraft = id_aircraft;
            this.detail_revision.serverParams.id_revision = id_revision;
            this.form_editor.id_revision = id_revision;
            this.id_revision = id_revision;
            this.id_aircraft = id_aircraft;

            
            this.findDetailRevision().then(() => {
                this.loading.isDetailLoading = false;
            })

            
        },

        findDetailRevision: function() {
            this.loading.isDetailLoading = true;
            this.detail_revision.serverParams.searchTerm = "";
            // this.$refs['tableDetailRevision'].reset();
            return new Promise((resolve, reject) => {
                axios.post('/api/task/get_task_by_revision', this.detail_revision.serverParams)
                .then(res => {
                    this.detail_revision.rows = res.data.data
                    this.detail_revision.totalRows = res.data.total
                    resolve();
                })
                .catch(e => {
                    console.log("Error: "+e)
                    toastr.error("Undefined error")
                    this.loading.isDetailLoading = false;
                    resolve();
                })
            })
        },

        handlerShowRevision: function() {
            this.message = "";
            this.isRevisionShow = true;
            this.isDetailRevisionShow = false;
            this.isAddMPDShow = false;
        },


        /**
         * Datatable
         */
        updateParams(newProps) {
            this.detail_revision.serverParams = Object.assign({}, this.detail_revision.serverParams, newProps);
        },
        
        onPageChange(params) {
            this.updateParams({page: params.currentPage});
            this.loadItems();
        },

        onPerPageChange(params) {
            this.updateParams({perPage: params.currentPerPage});
            this.loadItems();
        },

        onSortChange(params) {
            this.updateParams({
                sort: {
                    type: params[0].type,
                    field: params[0].field,
                },
            });
            this.updateParams({page: 1});
            this.loadItems();
        },
        
        onColumnFilter(params) {
            this.updateParams(params);
            this.loadItems();
        },

        onColumnSearch(params) {
            this.updateParams(params);
            this.updateParams({page: 1});
            this.loadItems();

        },

        /**
         * load items is what brings back the rows from server
         */
        loadItems() {
            this.handleDatatableChange(this.detail_revision.serverParams).then(()=> {
                this.loading.isDetailLoading = false;
            });
        },

        handleDatatableChange: function(params) {
            this.loading.isDetailLoading = true;
            return new Promise((resolve, reject) => {
                axios.post('/api/task/get_task_by_revision', params)
                .then(res => {
                    this.detail_revision.rows = res.data.data
                    this.detail_revision.totalRows = res.data.total
                    resolve();
                })
                .catch(e => {
                    console.log("Error: "+e)
                    this.loading.isDetailLoading = true;
                    toastr.error("Undefined error");
                    resolve();
                })
            })
        },

        handleModalEditor: function(id_aircraft, task_number) {
            this.form_editor.aircraft_type = id_aircraft;
            this.form_editor.mpd_number = task_number;

            this.editor.core.zone = [];
            this.editor.core.detail_zone = [];
            this.editor.preparation.preparation = [];
            this.editor.preparation.detail_preparation = [];
            this.editor.material.part = [];
            this.editor.material.detail_material = [];

            this.editor.core.isShow = false;
            this.editor.preparation.isShow = false;
            this.editor.material.isShow = false;
            this.editor.access.isShow = false;
            this.editor_type = '';


            $('#modal-editor').show();
        },

        /**
         * Hide modal
         * @param modal_name String
         */
        hideModal: function(modal_name) {
            $('#' + modal_name).hide();
        },

        handleFindEditor: function() {
            this.loading.isLoadingEditor = true;
            this.editor.core.isShow = false;
            this.editor.preparation.isShow = false;
            this.editor.material.isShow = false;
            this.editor.access.isShow = false;
            this.editor.material_prep.isShow = false;
            this.editor.reference.isShow = false;
            this.editor.reference.isShow = false;
            this.editor.core_material.isShow = false;
            
            // this.editor.material_ref.isShow = false;

            axios.post('/api/task/get_detail_task', this.form_editor)
            .then(res => {
                if(res.data.hasOwnProperty("ID")) {
                    this.detail_task = res.data;

                    switch(this.editor_type) {
                        case "description" :
                            break;
                        case "core_task" :
                            // core task handler
                            this.handlerFindCoreEditor();
                            break;
                        case "preparation" :
                            // preparation handler
                            this.handlerFindPreparationEditor();
                            break;
                        case "access" :
                            // access handler
                            this.handlerFindAccessEditor();
                            break;
                        case "material_tools" :
                            this.handlerFindMaterialEditor();
                            break;
                        case "core_material" :
                            this.handlerFindCoreMaterialEditor();
                            break;
                        case "material_prep" :
                            this.handlerFindMaterialPrepEditor();
                            break;
                        case "reference" :
                            // reference
                            this.handlerFindReferenceEditor();
                            break;
                        case "material_ref" :
                            this.handlerFindMaterialRefEditor();
                            break;
                        default:
                            toastr.warning('Wrong editor type');
                            this.loading.isLoadingEditor = false;
                    }
                }else{
                    this.loading.isLoadingEditor = false;
                    toastr.warning("No data found")
                }
            })
            .catch(e => {
                console.log("Error: "+e);
                this.loading.isLoadingEditor = false;
                toastr.error("Undefined error")

            })
        },

        /**
         * Core editor
         */
        handlerFindCoreEditor: function() {
            this.initZone().then(() => {
                this.initDetailZone().then(() => {
                    this.loading.isLoadingEditor = false;
                    this.editor.core.isShow = true;
                })
            })  
        },

        addRowCore: function(id) {
            this.editor.core.detail_zone.push({
                IDX: id,
                ID: "",
                ZONE: "",
                MEN: "",
                MH: "" ,
                ID_ZONE: ""
            })
        },
        
        postCore: function(index, status) {
            this.loading.isLoadingEditor = true;
            let edt_core_id = document.getElementsByClassName('edt-core-id')[index].value;
            let edt_core_zone = document.getElementsByClassName('edt-core-zone')[index].value;
            let edt_core_men = document.getElementsByClassName('edt-core-men')[index].value;
            let edt_core_mh = document.getElementsByClassName('edt-core-mh')[index].value;
            
            let data_validation = [
                {'element': edt_core_zone, 'type' : 'Zone', 'data' : 'string'},
                {'element': edt_core_men    , 'type' : 'Men', 'data' : 'number'},
                {'element': edt_core_mh, 'type' : 'Mh', 'data' : 'number'}
            ];

            if(!this.validation(data_validation)) {
                this.loading.isLoadingEditor = false;
                return;
            } 
            if(status == "update") {
                swal({
                    title: "Continue update this item ?",
                    text: "Are you sure?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                .then((value) => {
                    if (value) {
                        axios.post('/api/task/update_detail_zone', {
                            id: edt_core_id,
                            id_task: this.detail_task.ID,
                            id_zone: edt_core_zone,
                            men: edt_core_men,
                            mh: edt_core_mh

                        })
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindCoreEditor();
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoadingEditor = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoadingEditor = false;
                            toastr.error("Undefined error")

                        })
                    } else {
                        this.loading.isLoadingEditor = false;
                        toastr.info("Canceled");
                    }
                });
            }else if(status == "insert") {
                swal({
                    title: "Continue add this item ?",
                    text: "Are you sure?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                .then((value) => {
                    if (value) {
                        axios.post('/api/task/insert_detail_zone', {
                            id_task: this.detail_task.ID,
                            id_zone: edt_core_zone,
                            men: edt_core_men,
                            mh: edt_core_mh,    
                            id_revision: this.form_editor.id_revision
                        })
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindCoreEditor();
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoadingEditor = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoadingEditor = false;
                            toastr.error("Undefined error")
                        })
                    } else {
                        this.loading.isLoadingEditor = false;
                        toastr.info("Canceled");
                    }
                });
            }else {
                this.loading.isLoadingEditor = false;
            }
        },

        removeRowCore: function(row_index, id) {
            swal({
                title: "Continue remove this item ?",
                text: "Are you sure?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    if(id !== '') {
                        axios.get('/api/task/delete_detail_zone/' + id)
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.editor.core.detail_zone.splice(row_index, 1);
                                this.handlerFindCoreEditor();
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoading = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoading = false;
                            toastr.error("Undefined error")

                        })
                    }else {
                        this.editor.core.detail_zone.splice(row_index, 1);
                        toastr.success("Success remove item")
                    }
                } else {
                    this.loading.isLoading = false;
                    toastr.info("Canceled");
                }
            });
        },

        /**
         * Preparation editor
         */
        handlerFindPreparationEditor: function() {
            this.initPreparation().then(() => {
                this.initDetailPreparation().then(() => {
                    this.loading.isLoadingEditor = false;
                    this.editor.preparation.isShow = true;
                })
            })  
        },

        addRowPreparation: function(id) {
            this.editor.preparation.detail_preparation.push({
                IDX: id,
                ID: "",
                PREPARATION: "",
                PREP_M_H: "",
                ID_PREPARATION: ""
            })
        },

        removeRowPreparation: function(row_index, id) {
            swal({
                title: "Continue remove this item ?",
                text: "Are you sure?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    if(id !== '') {
                        axios.get('/api/task/delete_detail_preparation/' + id)
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.editor.preparation.detail_preparation.splice(row_index, 1);
                                this.handlerFindPreparationEditor();
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoading = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoading = false;
                            toastr.error("Undefined error")

                        })
                    }else {
                        this.editor.preparation.detail_preparation.splice(row_index, 1);
                        toastr.success("Success remove item")
                    }
                } else {
                    this.loading.isLoading = false;
                    toastr.info("Canceled");
                }
            });
        },

        postPreparation: function(index, status) {
            this.loading.isLoadingEditor = true;
            let edt_det_preparation_id = document.getElementsByClassName('edt-preparation-id')[index].value;
            let edt_preparation_id = document.getElementsByClassName('edt-preparation-preparation')[index].value;
            let edt_preparation_mh = document.getElementsByClassName('edt-preparation-mh')[index].value;

            let data_validation = [
                {'element': edt_preparation_id, 'type' : 'Preparation', 'data' : 'string'},
                {'element': edt_preparation_mh, 'type' : 'MH', 'data' : 'number'}
            ];

            if(!this.validation(data_validation)) {
                this.loading.isLoadingEditor = false;
                return;
            } 
            if(status == "update") {
                swal({
                    title: "Continue update this item ?",
                    text: "Are you sure?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                .then((value) => {
                    if (value) {
                        axios.post('/api/task/update_detail_preparation', {
                            id: edt_det_preparation_id,
                            id_preparation: edt_preparation_id,
                            mh: edt_preparation_mh

                        })
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindPreparationEditor();
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoadingEditor = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoadingEditor = false;
                            toastr.error("Undefined error")

                        })
                    } else {
                        this.loading.isLoadingEditor = false;
                        toastr.info("Canceled");
                    }
                });
            }else if(status == "insert") {
                swal({
                    title: "Continue add this item ?",
                    text: "Are you sure?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                .then((value) => {
                    if (value) {
                        axios.post('/api/task/insert_detail_preparation', {
                            id_task: this.detail_task.ID,
                            id_preparation: edt_preparation_id,
                            mh: edt_preparation_mh
                        })
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindPreparationEditor();
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoadingEditor = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoadingEditor = false;
                            toastr.error("Undefined error")

                        })
                    } else {
                        this.loading.isLoadingEditor = false;
                        toastr.info("Canceled");
                    }
                });
            }else {
                this.loading.isLoadingEditor = false;
            }
        },

        /**
         * Material editor
         */
        handlerFindMaterialEditor: function() {
            this.initMaterial().then(() => {
                this.initDetailMaterial().then(() => {
                    this.loading.isLoadingEditor = false;
                    this.editor.material.isShow = true;
                })
            })  
        },

        addRowMaterial: function(id) {
            this.editor.material.detail_material.push({
                IDX: id,
                // IDT: this.editor.material.detail_material[0].IDT,
                EXPENDABLE: "",
                ID: "",
                PART_DESC: "",
                PART_NUMBER: "" ,
                QTY: "" ,
            })
        },

        removeRowMaterial: function(row_index, id, type) {
            swal({
                title: "Continue remove this item ?",
                text: "Are you sure?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    if(id !== '') {
                        axios.get('/api/task/delete_detail_material/' + id)
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindMaterialEditor();
                                this.editor.material.detail_material.splice(row_index, 1);
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoading = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoading = false;
                            toastr.error("Undefined error")

                        })
                    }else {
                        this.editor.material.detail_material.splice(row_index, 1);
                        toastr.success("Success remove item")
                    }
                } else {
                    this.loading.isLoading = false;
                    toastr.info("Canceled");
                }
            });
        },

        postMaterial: function(index, status) {
            this.loading.isLoadingEditor = true;

            let edt_det_material_id = document.getElementsByClassName('edt-material-id')[index].value;
            let edt_material_part = document.getElementsByClassName('edt-material-part')[index].value;
            let edt_material_qty = document.getElementsByClassName('edt-material-qty')[index].value;
            let idt = this.detail_task.ID;



            let data_validation = [
                {'element': edt_material_part, 'type' : 'Part number', 'data': 'string'},
                {'element': edt_material_qty, 'type' : 'QTY', 'data': 'number'}
            ];

            if(!this.validation(data_validation)) {
                this.loading.isLoadingEditor = false;
                return;
            } 
            if(status == "update") {
                swal({
                    title: "Continue update this item ?",
                    text: "Are you sure?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                .then((value) => {
                    if (value) {
                        axios.post('/api/task/update_detail_material', {
                            id: edt_det_material_id,    
                            idt: idt,
                            id_part: edt_material_part,
                            qty: edt_material_qty,

                        })
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindMaterialEditor();
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoadingEditor = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoadingEditor = false;
                            toastr.error("Undefined error")

                        })
                    } else {
                        this.loading.isLoadingEditor = false;
                        toastr.info("Canceled");
                    }
                });
            }else if(status == "insert") {
                swal({
                    title: "Continue add this item ?",
                    text: "Are you sure?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                .then((value) => {
                    if (value) {
                        axios.post('/api/task/insert_detail_material', {
                            idt: idt,
                            id_part: edt_material_part,
                            qty: edt_material_qty,
                        })
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindMaterialEditor();
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoadingEditor = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoadingEditor = false;
                            toastr.error("Undefined error")

                        })
                    } else {
                        this.loading.isLoadingEditor = false;
                        toastr.info("Canceled");
                    }
                });
            }else {
                this.loading.isLoadingEditor = false;
            }
        },

        /**
         * Core Material editor
         */
        handlerFindCoreMaterialEditor: function() {
                this.initDetailMaterial().then(() => {
                    this.initDetailCoreMaterial().then(() => {
                        this.loading.isLoadingEditor = false;
                        this.editor.core_material.isShow = true;
                    })
                }) 
        },

        addRowCoreMaterial: function(id) {
            this.editor.core_material.detail_core_material.push({
                IDX: id,
                ID: "",
                MATERIAL_NUMBER: "" ,
                PART_NUMBER: "" ,
                ID_DET_TASK_PART: "" ,
                STATUS: ""
            })
        },

        postCoreMaterial: function(index, status) {
            this.loading.isLoadingEditor = true;

            let edt_det_material_id = document.getElementsByClassName('edt-material-core-id')[index].value;
            let edt_material_part = document.getElementsByClassName('edt-material-core-part')[index].value;
            let edt_material_number = document.getElementsByClassName('edt-material-core-number')[index].value;
            let edt_material_status = document.getElementsByClassName('edt-material-core-status')[index].value;
            let idt = this.detail_task.ID;

            let data_validation = [
                {'element': edt_material_number, 'type' : 'Material number', 'data': 'string'},
                {'element': edt_material_part, 'type' : 'Part number', 'data': 'string'},
                {'element': edt_material_status, 'type' : 'Material status', 'data': 'string'}
            ];

            if(!this.validation(data_validation)) {
                this.loading.isLoadingEditor = false;
                return;
            } 
            if(status == "update") {
                swal({
                    title: "Continue update this item ?",
                    text: "Are you sure?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                .then((value) => {
                    if (value) {
                        axios.post('/api/task/update_detail_core_material', {
                            id: edt_det_material_id, 
                            id_det_task_part: edt_material_part,   
                            material_number: edt_material_number,
                            status: edt_material_status,

                        })
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindCoreMaterialEditor();
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoadingEditor = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoadingEditor = false;
                            toastr.error("Undefined error")


                        })
                    } else {
                        this.loading.isLoadingEditor = false;
                        toastr.info("Canceled");
                    }
                });
            }else if(status == "insert") {
                swal({
                    title: "Continue add this item ?",
                    text: "Are you sure?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                .then((value) => {
                    if (value) {
                        axios.post('/api/task/insert_detail_core_material', {
                            id_det_task_part: edt_material_part,
                            material_number: edt_material_number,
                            status: edt_material_status,
                            idt: idt
                        })
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindCoreMaterialEditor();
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoadingEditor = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoadingEditor = false;
                            toastr.error("Undefined error")


                        })
                    } else {
                        this.loading.isLoadingEditor = false;
                        toastr.info("Canceled");
                    }
                });
            }else {
                this.loading.isLoadingEditor = false;
            }
        },

        removeRowCoreMaterial: function(row_index, id) {
            swal({
                title: "Continue remove this item ?",
                text: "Are you sure?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    if(id !== '') {
                        axios.get('/api/task/delete_detail_core_material/' + id)
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindCoreMaterialEditor();
                                this.editor.material.detail_material.splice(row_index, 1);
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoading = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoading = false;
                            toastr.error("Undefined error")

                        })
                    }else {
                        this.editor.core_material.detail_core_material.splice(row_index, 1);
                        toastr.success("Success remove item")
                    }
                } else {
                    this.loading.isLoading = false;
                    toastr.info("Canceled");
                }
            });
        },

        

        /**
         * Access editor
         */
        handlerFindAccessEditor: function() {
            this.initAccess().then(() => {
                this.initDetailAcessZone().then(() => {
                    this.initDetailAccess().then(() => {
                        this.loading.isLoadingEditor = false;
                        this.editor.access.isShow = true;
                    })
                })
            })  
        },

        addRowAccess: function(id) {
            this.editor.access.detail_access.push({
                IDX: id,
                ID: "",
                ACCESS: "",
                MEN: "",
                MEN_INSTALL: "",
                MH: "",
                MH_INSTALL: "",
                ZONE: ""

            })
        },

        removeRowAccess: function(row_index, id) {
            swal({
                title: "Continue remove this item ?",
                text: "Are you sure?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    if(id !== '') {
                        axios.get('/api/task/delete_detail_access/' + id)
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindAccessEditor();
                                this.editor.access.detail_access.splice(row_index, 1);
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoadingEditor = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoadingEditor = false;
                            toastr.error("Undefined error")

                        })
                    }else {
                        this.editor.access.detail_access.splice(row_index, 1);
                        toastr.success("Success remove item")
                    }
                } else {
                    this.loading.isLoading = false;
                    toastr.info("Canceled");
                }
            });
        },

        postAccess: function(index, status) {
            this.loading.isLoadingEditor = true;

            let edt_det_access_id = document.getElementsByClassName('edt-det_access-id')[index].value;
            let edt_det_access_zone_id = document.getElementsByClassName('edt-access-zone')[index].value;
            let edt_access_id = document.getElementsByClassName('edt-access-access')[index].value;
            let edt_access_mh = document.getElementsByClassName('edt-access-mhrs')[index].value;
            let edt_access_mh_install = document.getElementsByClassName('edt-access-mhrs-install')[index].value;
            let edt_access_men = document.getElementsByClassName('edt-access-men')[index].value;
            let edt_access_men_install = document.getElementsByClassName('edt-access-men-install')[index].value;

            let data_validation = [
                {'element': edt_access_mh, 'type' : 'MH', 'data' : 'number'},
                {'element': edt_access_mh_install, 'type' : 'MH Install', 'data' : 'number'},
                {'element': edt_access_men, 'type' : 'Men', 'data' : 'number'},
                {'element': edt_access_mh_install, 'type' : 'Men Install', 'data' : 'number'},
            ];

            if(!this.validation(data_validation)) {
                this.loading.isLoadingEditor = false;
                return;
            } 
            if(status == "update") {
                swal({
                    title: "Continue update this item ?",
                    text: "Are you sure?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                .then((value) => {
                    if (value) {
                        axios.post('/api/task/update_access', {
                            id: edt_access_id,
                            mh: edt_access_mh,
                            mh_install: edt_access_mh_install,
                            men: edt_access_men,
                            men_install: edt_access_men_install
                        })
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindAccessEditor();
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoadingEditor = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoadingEditor = false;
                            toastr.error("Undefined error")

                        })
                    } else {
                        this.loading.isLoadingEditor = false;
                        toastr.info("Canceled");
                    }
                });
            }else if(status == "insert") {
                swal({
                    title: "Continue add this item ?",
                    text: "Are you sure?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                .then((value) => {
                    if (value) {
                        axios.post('/api/task/insert_detail_access', {
                            id_task: this.detail_task.ID,
                            id_det_zone: edt_det_access_zone_id,
                            id_access: edt_access_id
                        })
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindAccessEditor();
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoadingEditor = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoadingEditor = false;
                            toastr.error("Undefined error")

                        })
                    } else {
                        this.loading.isLoading = false;
                        toastr.info("Canceled");
                    }
                });
            }else {
                this.loading.isLoadingEditor = false;
            }
        },


        /**
         * Material prep editor
         */
        handlerFindMaterialPrepEditor: function() {
            this.initDetailPreparation().then(() => {
                this.initMaterial().then(() => {
                    this.initDetailPrepMaterial().then(() => {
                        this.loading.isLoadingEditor = false;
                        this.editor.material_prep.isShow = true;
                    })
                })  
            }) 
        },

        addRowMaterialPrep: function(id) {
            this.editor.material_prep.detail_material_prep.push({
                IDX: id,
                ID: "",
                PART_NUMBER: "" ,
                QTY: "" ,
                PREPARATION: ""
            })
        },

        postMaterialPrep: function(index, status) {
            this.loading.isLoadingEditor = true;

            let edt_det_material_prep_id = document.getElementsByClassName('edt-material-prep-id')[index].value;
            let edt_det_material_part_id = document.getElementsByClassName('edt-material-prep-part')[index].value;
            let edt_preparation_id = document.getElementsByClassName('edt-material-preparation')[index].value;
            let edt_material_prep_qty = document.getElementsByClassName('edt-material-prep-qty')[index].value;

            let data_validation = [
                {'element': edt_material_prep_qty, 'type' : 'QTY', 'data' : 'number'}
            ];

            if(!this.validation(data_validation)) {
                this.loading.isLoadingEditor = false;
                return;
            } 
            if(status == "update") {
                swal({
                    title: "Continue update this item ?",
                    text: "Are you sure?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                .then((value) => {
                    if (value) {
                        axios.post('/api/task/update_material_prep', {
                            id: edt_det_material_prep_id,
                            qty: edt_material_prep_qty

                        })
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindMaterialPrepEditor();
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoadingEditor = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoadingEditor = false;
                            toastr.error("Undefined error")
                        })
                    } else {
                        this.loading.isLoadingEditor = false;
                        toastr.info("Canceled");
                    }
                });
            }else if(status == "insert") {
                swal({
                    title: "Continue add this item ?",
                    text: "Are you sure?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                .then((value) => {
                    if (value) {
                        axios.post('/api/task/insert_detail_material_prep', {
                            id_task: this.detail_task.ID,
                            id_det_prep: edt_preparation_id,
                            id_part: edt_det_material_part_id,
                            qty: edt_material_prep_qty
                        })
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindMaterialPrepEditor();
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoadingEditor = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoadingEditor = false;
                            toastr.error("Undefined error")


                        })
                    } else {
                        this.loading.isLoading = false;
                        toastr.info("Canceled");
                    }
                });
            }else {
                this.loading.isLoadingEditor = false;
            }
        },

        removeRowMaterialPrep: function(row_index, id, type) {
            swal({
                title: "Continue remove this item ?",
                text: "Are you sure?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    if(id !== '') {
                        axios.get('/api/task/delete_detail_material_prep/' + id)
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindMaterialPrepEditor();
                                this.editor.material_prep.detail_material_prep.splice(row_index, 1);
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoading = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoading = false;
                            toastr.error("Undefined error")

                        })
                    }else {
                        this.editor.material_prep.detail_material_prep.splice(row_index, 1);
                        toastr.success("Success remove item")
                    }
                } else {
                    this.loading.isLoading = false;
                    toastr.info("Canceled");
                }
            });
        },


        /**
         * Reference editor
         */
        handlerFindReferenceEditor: function() {
            this.initDetailReference().then(() => {
                this.loading.isLoadingEditor = false;
                this.editor.reference.isShow = true;
            })  
        },

        addRowReference: function(id) {
            this.editor.reference.detail_reference.push({
                IDX: id,
                ID: "",
                MEN: "",
                MH: "",
                REFERENCE_INFORMATION: "",
            })
        },

        postReference: function(index, status) {
            this.loading.isLoadingEditor = true;

            let edt_ref_id = document.getElementsByClassName('edt-reference-id')[index].value;
            let edt_det_ref_number = document.getElementsByClassName('edt-reference-number')[index].value;
            let edt_det_ref_information = document.getElementsByClassName('edt-reference-information')[index].value;
            let edt_det_ref_men = document.getElementsByClassName('edt-reference-men')[index].value;
            let edt_det_ref_mh = document.getElementsByClassName('edt-reference-mh')[index].value;

            let data_validation = [
                {'element': edt_det_ref_information, 'type' : 'Reference information', 'data' : 'text'},
                {'element': edt_det_ref_men, 'type' : 'Men', 'data' : 'number'},
                {'element': edt_det_ref_mh, 'type' : 'MH', 'data' : 'number'},
            ];

            if(!this.validation(data_validation)) {
                this.loading.isLoadingEditor = false;
                return;
            } 
            
            if(status == "update") {
                swal({
                    title: "Continue update this item ?",
                    text: "Are you sure?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                .then((value) => {
                    if (value) {
                        axios.post('/api/task/update_detail_ref', {
                            id: edt_ref_id,
                            reference_information: edt_det_ref_information,
                            men: edt_det_ref_men,
                            mh: edt_det_ref_mh,

                        })
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindReferenceEditor();
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoadingEditor = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoadingEditor = true;
                            toastr.error("Undefined error")

                        })
                    } else {
                        this.loading.isLoadingEditor = false;
                        toastr.info("Canceled");
                    }
                });
            }else if(status == "insert") {
                swal({
                    title: "Continue add this item ?",
                    text: "Are you sure?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                .then((value) => {
                    if (value) {
                        axios.post('/api/task/insert_detail_ref', {
                            id_task: this.detail_task.ID,
                            ref_number: edt_det_ref_number,
                            ref_information: edt_det_ref_information,
                            men: edt_det_ref_men,
                            mh: edt_det_ref_mh
                        })
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.handlerFindReferenceEditor();
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoadingEditor = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            this.loading.isLoadingEditor = false;
                            toastr.error("Undefined error")

                        })
                    } else {
                        this.loading.isLoadingEditor = false;
                        toastr.info("Canceled");
                    }
                });
            }else {
                this.loading.isLoadingEditor = false;
            }
        },

        removeRowReference: function(row_index, id) {
            swal({
                title: "Continue remove this item ?",
                text: "Are you sure?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    if(id !== '') {
                        axios.get('/api/task/delete_detail_ref/' + id)
                        .then(res => {
                            if(res.data.success) {
                                toastr.success(res.data.message)
                                this.editor.reference.detail_reference.splice(row_index, 1);
                                this.handlerFindReferenceEditor();
                            }else {
                                toastr.warning(res.data.message)
                            }
                            this.loading.isLoading = false;
                        })
                        .catch(e => {
                            console.log("Error: "+e);
                            toastr.error("Undefined error")
                            this.loading.isLoading = false;

                        })
                    }else {
                        this.editor.reference.detail_reference.splice(row_index, 1);
                        toastr.success("Success remove item")
                    }
                } else {
                    this.loading.isLoading = false;
                    toastr.info("Canceled");
                }
            });
        },

        /**
         * Material ref editor
         */
        // handlerFindMaterialRefEditor: function() {
        //     this.initDetailReference().then(() => {
        //         this.initMaterial().then(() => {
        //             this.initDetailRefMaterial().then(() => {
        //                 this.loading.isLoadingEditor = false;
        //                 this.editor.material_ref.isShow = true;
        //             })
        //         })  
        //     }) 
        // },

        // addRowMaterialRef: function(id) {
        //     this.editor.material_ref.detail_material_ref.push({
        //         IDX: id,
        //         ID: "",
        //         PART_NUMBER: "" ,
        //         QTY: "" ,
        //         REFERENCE_ID: "",
        //         REFERENCE_INFORMATION: "",
        //     })
        // },

        // postMaterialRef: function(index, status) {
        //     this.loading.isLoadingEditor = true;

        //     let edt_det_material_ref_id = document.getElementsByClassName('edt-material-ref-id')[index].value;
        //     let edt_reference_id = document.getElementsByClassName('edt-material-ref')[index].value;
        //     let edt_material_ref_part_id = document.getElementsByClassName('edt-material-ref-part')[index].value;
        //     let edt_material_ref_qty = document.getElementsByClassName('edt-material-ref-qty')[index].value;

        //     let data_validation = [
        //         {'element': edt_material_ref_qty, 'type' : 'QTY', 'data' : 'number'}
        //     ];

        //     if(!this.validation(data_validation)) {
        //         this.loading.isLoadingEditor = false;
        //         return;
        //     } 
        //     if(status == "update") {
        //         swal({
        //             title: "Continue update this item ?",
        //             text: "Are you sure?",
        //             icon: "warning",
        //             buttons: true,
        //             dangerMode: true,
        //         })
        //         .then((value) => {
        //             if (value) {
        //                 axios.post('/api/task/update_material_ref', {
        //                     id: edt_det_material_ref_id,
        //                     qty: edt_material_ref_qty

        //                 })
        //                 .then(res => {
        //                     if(res.data.success) {
        //                         toastr.success(res.data.message)
        //                         this.handlerFindMaterialRefEditor();
        //                     }else {
        //                         toastr.warning(res.data.message)
        //                     }
        //                     this.loading.isLoadingEditor = false;
        //                 })
        //                 .catch(e => {
        //                     console.log("Error: "+e);
        //                     this.loading.isLoadingEditor = false;
        //                 })
        //             } else {
        //                 this.loading.isLoadingEditor = false;
        //                 toastr.info("Canceled");
        //             }
        //         });
        //     }else if(status == "insert") {
        //         swal({
        //             title: "Continue add this item ?",
        //             text: "Are you sure?",
        //             icon: "warning",
        //             buttons: true,
        //             dangerMode: true,
        //         })
        //         .then((value) => {
        //             if (value) {
        //                 axios.post('/api/task/insert_detail_material_ref', {
        //                     id_task: this.detail_task.ID,
        //                     id_det_ref: edt_reference_id,
        //                     id_part: edt_material_ref_part_id,
        //                     qty: edt_material_ref_qty
        //                 })
        //                 .then(res => {
        //                     if(res.data.success) {
        //                         toastr.success(res.data.message)
        //                         this.handlerFindMaterialRefEditor();
        //                     }else {
        //                         toastr.warning(res.data.message)
        //                     }
        //                     this.loading.isLoadingEditor = false;
        //                 })
        //                 .catch(e => {
        //                     console.log("Error: "+e);
        //                     this.loading.isLoadingEditor = false;

        //                 })
        //             } else {
        //                 this.loading.isLoading = false;
        //                 toastr.info("Canceled");
        //             }
        //         });
        //     }else {
        //         this.loading.isLoadingEditor = false;
        //     }
        // },

        // removeRowMaterialRef: function(row_index, id, type) {
        //     swal({
        //         title: "Continue remove this item ?",
        //         text: "Are you sure?",
        //         icon: "warning",
        //         buttons: true,
        //         dangerMode: true,
        //     })
        //     .then((value) => {
        //         if (value) {
        //             if(id !== '') {
        //                 axios.get('/api/task/delete_detail_material_ref/' + id)
        //                 .then(res => {
        //                     if(res.data.success) {
        //                         toastr.success(res.data.message)
        //                         this.handlerFindMaterialRefEditor();
        //                         this.editor.material_prep.detail_material_prep.splice(row_index, 1);
        //                     }else {
        //                         toastr.warning(res.data.message)
        //                     }
        //                     this.loading.isLoading = false;
        //                 })
        //                 .catch(e => {
        //                     console.log("Error: "+e);
        //                 })
        //             }else {
        //                 this.editor.material_ref.detail_material_ref.splice(row_index, 1);
        //                 toastr.success("Success remove item")
        //             }
        //         } else {
        //             this.loading.isLoading = false;
        //             toastr.info("Canceled");
        //         }
        //     });
        // },


        validation: function(elements) {
            for(let i = 0; i < elements.length; i++) {
                if(elements[i].data == "number") {
                    if(elements[i].element <= 0) {
                        toastr.warning(elements[i].type + ' cant be empty');
                        return false;
                    }
                }else {
                    if(elements[i].element == "") {
                        toastr.warning(elements[i].type + ' cant be empty');
                        return false;
                    }
                }
            }
            return true;
        },

        handlerModalDetailMPD:function(id_aircraft, task_number) {
            this.editor.core.detail_zone = [];
            this.editor.access.detail_access = [];
            this.editor.material.detail_material = [];
            this.editor.preparation.detail_preparation = [];
            this.editor.reference.detail_reference = [];

            this.editor.isDetailMPDShow = false;
            this.loading.isLoadingDetailMPD = true;
            let temp_mpd = this.detail_revision.rows.filter(d => d.ID_AIRCRAFT === id_aircraft && d.TASK_NUMBER === task_number);
            this.detail_mpd = temp_mpd;
            this.form_editor.mpd_number = task_number;
            this.form_editor.aircraft_type = id_aircraft;
            this.form_editor.id_revision = this.id_revision;
            $("#modal-detail-mpd").show();


            this.initDetailZone().then(() => {
                this.initDetailAccess().then(() => {
                    this.initDetailMaterialAll().then(() => {
                        this.initDetailPreparation().then(() => {
                            this.initDetailReference().then(() => {
                                this.editor.isDetailMPDShow = true;
                                this.loading.isLoadingDetailMPD = false;
                            })
                        })
                    })
                })
            })
        },

        handlerActivateRevision: function(id, id_revision) {
            swal({
                title: "Continue set this revision as active ?",
                text: "Are you sure?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    this.loading.isLoading = true;
                    axios.post('/api/revision/set_active', {
                        id: id,
                        id_aircraft: id_revision,
                    })
                    .then(res => {
                        if(res.data.success) {
                            toastr.success(res.data.message)
                            this.findRevision();
                        }else {
                            toastr.warning(res.data.message)
                        }
                        this.loading.isLoading = false;
                    })
                    .catch(e => {
                        console.log("Error: "+e);
                        this.loading.isLoading = false;
                        toastr.error("Undefined error")

                    })
                } else {
                    toastr.info("Canceled");
                }
            });
        },

        handlerExportRevision: function(id_revision, id_aircraft, name) {
            this.loading.isLoadingClone = true;
            axios.get(`/api/task/export_revision/${id_revision}/${id_aircraft}`)
            .then(res => {
                if(!res.data.success) {
                    toastr.warning("Data not available");
                    return;
                }

                this.handlerExport(res.data.data, name).then(() => {
                    this.loading.isLoadingClone = false;
                });
            })
            .catch(e => {
                console.log("Error: " + e);
                this.loading.isLoadingClone = false;
                toastr.error("Undefined error")

            })
        },

        handlerExport: function(data, name) {
            return new Promise((resolve, reject) => {
                let detail_task = XLSX.utils.json_to_sheet(data.detail_task) 
                let detail_zone = XLSX.utils.json_to_sheet(data.detail_zone) 
                let detail_access = XLSX.utils.json_to_sheet(data.detail_access) 
                let detail_zone_access = XLSX.utils.json_to_sheet(data.detail_zone_access) 
                let detail_part = XLSX.utils.json_to_sheet(data.detail_part) 
                let detail_material = XLSX.utils.json_to_sheet(data.detail_material) 
                let detail_preparation = XLSX.utils.json_to_sheet(data.detail_preparation) 
                let detail_preparation_part = XLSX.utils.json_to_sheet(data.detail_preparation_part) 
                let detail_reference = XLSX.utils.json_to_sheet(data.detail_reference) 
                // let detail_reference_part = XLSX.utils.json_to_sheet(data.detail_reference_part) 
                
                let wb = XLSX.utils.book_new();

                XLSX.utils.book_append_sheet(wb, detail_access, 'M ACCESS') 
                XLSX.utils.book_append_sheet(wb, detail_task, 'M TASK') 
                XLSX.utils.book_append_sheet(wb, detail_zone, 'DET TASK ZONE') 
                XLSX.utils.book_append_sheet(wb, detail_zone_access, 'DET TASK ACCESS') 
                XLSX.utils.book_append_sheet(wb, detail_part, 'DET TASK PART') 
                XLSX.utils.book_append_sheet(wb, detail_material, 'DET TASK MATERIAL') 
                XLSX.utils.book_append_sheet(wb, detail_preparation, 'DET TASK PREPARATION') 
                XLSX.utils.book_append_sheet(wb, detail_preparation_part, 'DET TASK PREPARATION PART') 
                XLSX.utils.book_append_sheet(wb, detail_reference, 'DET TASK REFERENCE') 
                // XLSX.utils.book_append_sheet(wb, detail_reference_part, 'DET TASK REFERENCE PART') 

                XLSX.writeFile(wb, `${name}.xlsx`)

                resolve();
            })
        },

        handlerModalAddRevision: function() {
            this.form_revision.revision_name = "";
            this.form_revision.revision_desc = "";
            this.form_revision.revision_file = "";
            document.getElementById('revision-file').value = "";
            $("#modal-add-revision").show();
        },

        handleButton: function(id, status) {
            let element = document.getElementById(id);
            return new Promise((resolve, reject) => {
                if(status == "load") {
                    element.className += " is-loading";
                    element.disabled = true;

                    setTimeout(() => {
                       resolve(); 
                    }, 500);

                }else {
                    element.className = "button";
                    element.disabled = false;
                    resolve();
                }
            })
        },

        validationAddRevision: function() {
            if(this.form_revision.revision_name == "") {
                toastr.warning('Revision name cant be empty');
                return false;
            }

            if(this.form_revision.revision_desc == "") {
                toastr.warning('Revision desc cant be empty');
                return false;
            }

            if(this.form_revision.revision_file == "") {
                toastr.warning('Revision file cant be empty');
                return false;
            }

            return true;
        },

        /**
         * Handle selected input file
         */
        onChangeFileUpload: function(){
            if(document.getElementById("revision-file").files.length != 0 ){
                this.form_revision.revision_file = this.$refs.revision_file.files[0];
            }
        },

        addRevision: function() {
            if(!this.validationAddRevision()) {
                return;
            }

            toastr.info("Importing data. Please wait, this action may take several minutes.");

            let formData = new FormData();
            formData.append('id_aircraft', this.id_aircraft);
            formData.append('id_user', this.user.id);
            formData.append('revision_name', this.form_revision.revision_name);
            formData.append('revision_desc', this.form_revision.revision_desc);
            formData.append('revision_file', this.form_revision.revision_file);


            this.handleButton('btn-add-revision', 'load').then(() => {
                axios.post('/api/revision/add_revision', formData, {
                    headers: {
                        'Content-Type': 'multipart/form-data'
                    }
                })
                .then(res => {
                    if(res.data.success) {
                        toastr.success(res.data.message);
                        this.findRevision();
                        this.hideModal("modal-add-revision");
                    }else {
                        toastr.warning(res.data.message);
                    }
                    this.handleButton('btn-add-revision', 'stop');
                })
                .catch(e => {
                    console.log("Error " + e);
                    this.handleButton('btn-add-revision', 'stop');
                    toastr.error("Undefined error");
                })
            });
        },

        handlerDeleteRevision: function(id_revision, id_aircraft) {
            swal({
                title: "Continue remove this item ?",
                text: "Are you sure?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    this.loading.isLoading = true;
                    axios.get(`/api/revision/remove_revision/${id_revision}/${id_aircraft}`)
                    .then(res => {
                        if(res.data.success) {
                            toastr.success(res.data.message)
                            this.findRevision();
                        }else {
                            toastr.warning(res.data.message)
                        }
                        this.loading.isLoading = false;
                    })
                    .catch(e => {
                        console.log("Error: "+e);
                        this.loading.isLoading = false;
                        toastr.error("Undefined error")
                    })
                } else {
                    this.loading.isLoading = false;
                    toastr.info("Canceled");
                }
            });
        },

        handlerShowAddMPD: function() {
            this.isAddMPDShow = true;
            this.isRevisionShow = false;
            this.isDetailRevisionShow = false;
        },

        removeRowAddZone: function(row_index) {
            if(this.add.zone.rows[row_index].zone === "") {
                this.add.zone.rows.splice(row_index, 1);
                return;
            }


            swal({
                title: "Continue remove this item ?",
                text: "Are you sure?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    this.add.zone.rows.splice(row_index, 1);
                } else {
                    toastr.info("Canceled");
                }
            });
            
        },

        addRowInsertZone: function() {
            this.add.zone.rows.push({zone: "", men: "", mh: "" });
        },

        addRowInsertAccess: function() {
            let temp_zone = this.add.zone.rows.filter(d => d.zone !== "" );
            if(temp_zone.length < 1) {
                toastr.warning('Detail zone cant be empty');
                return;                
            }
            this.add.access.rows.push({zone: "", access: "", men_remove: "", men_install: "", mh_remove: "", mh_install: "" });
        },

        removeRowAddAccess: function(row_index) {
            if(this.add.access.rows[row_index].zone === "") {
                this.add.access.rows.splice(row_index, 1);
                return;
            }

            swal({
                title: "Continue remove this item ?",
                text: "Are you sure?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    this.add.access.rows.splice(row_index, 1);
                } else {
                    toastr.info("Canceled");
                }
            });
            
        },

        addRowInsertPrep: function() {
            this.add.preparation.rows.push({preparation: "", mh: "" });
        },

        removeRowAddPrep: function(row_index) {
            if(this.add.preparation.rows[row_index].preparation === "") {
                this.add.preparation.rows.splice(row_index, 1);
                return;
            }

            swal({
                title: "Continue remove this item ?",
                text: "Are you sure?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    this.add.preparation.rows.splice(row_index, 1);
                } else {
                    toastr.info("Canceled");
                }
            });
            
        },

        addRowInsertRef: function() {
            // if(this.add.task.reference === "") {
            //     toastr.warning('Reference is empty');
            //     return;
            // }

            this.add.reference.rows.push({reference_number: "", reference_information: "", men: "", mh: "" });
        },

        removeRowAddRef: function(row_index) {
            if(this.add.reference.rows[row_index].reference === "") {
                this.add.reference.rows.splice(row_index, 1);
                return;
            }

            swal({
                title: "Continue remove this item ?",
                text: "Are you sure?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    this.add.reference.rows.splice(row_index, 1);
                } else {
                    toastr.info("Canceled");
                }
            });
            
        },

        addRowInsertPart: function() {
            this.add.part.rows.push({part_number: "", type: "", qty: "" });
        },

        removeRowAddPart: function(row_index) {
            if(this.add.part.rows[row_index].part_number === "") {
                this.add.part.rows.splice(row_index, 1);
                return;
            }

            swal({
                title: "Continue remove this item ?",
                text: "Are you sure?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    this.add.part.rows.splice(row_index, 1);
                } else {
                    toastr.info("Canceled");
                }
            });
            
        },

        addRowInsertPrepPart: function() {
            let temp_prep = this.add.preparation.rows.filter(d => d.preparation !== "" );
            if(temp_prep.length < 1) {
                toastr.warning('Detail preparation cant be empty');
                return;                
            }
            this.add.preppart.rows.push({preparation: "", part_number: "", type: "", qty: "" });
        },


        removeRowAddPrepPart: function(row_index) {
            if(this.add.preppart.rows[row_index].part_number === "") {
                this.add.preppart.rows.splice(row_index, 1);
                return;
            }

            swal({
                title: "Continue remove this item ?",
                text: "Are you sure?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    this.add.preppart.rows.splice(row_index, 1);
                } else {
                    toastr.info("Canceled");
                }
            });
            
        },

        // addRowInsertRefPart: function() {
        //     let temp_prep = this.add.reference.rows.filter(d => d.reference_information !== "" );
        //     if(temp_prep.length < 1) {
        //         toastr.warning('Detail Reference cant be empty');
        //         return;                
        //     }
        //     this.add.refpart.rows.push({reference_information: "", part_number: "", type: "", qty: "" });
        // },

        addRowInsertMaterial: function() {
            let temp_prep = this.add.part.rows.filter(d => d.part_number !== "" );
            if(temp_prep.length < 1) {
                toastr.warning('Task part cant be empty');
                return;                
            }
            this.add.material.rows.push({material_number: "", part_number: "", status: ""});
        },

        removeRowAddMaterial: function(row_index) {
            if(this.add.material.rows[row_index].material_number === "") {
                this.add.material.rows.splice(row_index, 1);
                return;
            }

            swal({
                title: "Continue remove this item ?",
                text: "Are you sure?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    this.add.material.rows.splice(row_index, 1);
                } else {
                    toastr.info("Canceled");
                }
            });
            
        },

        handlerSaveMPD: function() {
            let elements = [
                {'element' : this.add.task.rev_code, 'type': 'Rev code'},
                {'element' : this.add.task.section, 'type': 'Section'},
                {'element' : this.add.task.mpd_number, 'type': 'MPD Number'},
                {'element' : this.add.task.pmps, 'type': 'PMPS'},
                {'element' : this.add.task.reference, 'type': 'Reference'},
                {'element' : this.add.task.applicability, 'type': 'Applicability'},
                {'element' : this.add.task.description, 'type': 'Description'},
            ];

            if(!this.validationAddMPD(elements)) return;

            this.loading.isLoadingAddMPD = true;
            axios.post('/api/task/add_mpd', {
                id_revision: this.id_revision,
                id_aircraft: this.id_aircraft,
                detail_task: this.add.task,
                detail_zone: this.add.zone.rows,
                detail_access: this.add.access.rows,
                detail_preparation: this.add.preparation.rows,
                detail_reference: this.add.reference.rows,
                detail_part: this.add.part.rows,
                detail_prep_part: this.add.preppart.rows,
                // detail_ref_part: this.add.refpart.rows
                detail_material: this.add.material.rows
            })
            .then(res => {
                if(res.data.success) {
                    toastr.success(res.data.message);
                }else {
                    toastr.warning(res.data.message);
                }
                this.loading.isLoadingAddMPD = false;
            })
            .catch(e => {
                console.log("Error: " + e);
                this.loading.isLoadingAddMPD = false;
                toastr.error("Undefined error")

            })
        },

        validationAddMPD: function(elements) {
            for(let i = 0; i < elements.length; i++) {
                if(elements[i].element <= 0) {
                    toastr.warning(elements[i].type + ' cant be empty');
                    return false;
                }
            }

            if(this.add.zone.rows.length < 1) {
                toastr.warning('Zone cant be empty');
                return false;
            }else {
                for(let i = 0; i < this.add.zone.rows.length; i++) {
                    if(this.add.zone.rows[i].zone === "") {
                        toastr.warning('Zone cant be empty');
                        return false;
                    }

                    if(this.add.zone.rows[i].men === "") {
                        toastr.warning('Zone Men cant be empty');
                        return false;
                    }

                    if(this.add.zone.rows[i].mh === "") {
                        toastr.warning('Zone MH cant be empty');
                        return false;
                    }
                }
            }

            if(this.add.access.rows.length > 0) {
                for(let i = 0; i < this.add.access.rows.length; i++) {
                    if(this.add.access.rows[i].zone === "") {
                        toastr.warning('Access zone cant be empty');
                        return false;
                    }

                    if(this.add.access.rows[i].access === "") {
                        toastr.warning('Access cant be empty');
                        return false;
                    }

                    if(this.add.access.rows[i].men === "") {
                        toastr.warning('Access Men cant be empty');
                        return false;
                    }

                    if(this.add.access.rows[i].mh === "") {
                        toastr.warning('Accesss MH cant be empty');
                        return false;
                    }
                }
            }

            if(this.add.preparation.rows.length > 0) {
                for(let i = 0; i < this.add.preparation.rows.length; i++) {
                    if(this.add.preparation.rows[i].preparation === "") {
                        toastr.warning('Preparation cant be empty');
                        return false;
                    }

                    if(this.add.preparation.rows[i].mh === "") {
                        toastr.warning('Preparation MH cant be empty');
                        return false;
                    }
                }
            }

            if(this.add.reference.rows.length > 0) {
                for(let i = 0; i < this.add.reference.rows.length; i++) {
                    if(this.add.reference.rows[i].reference_information === "") {
                        toastr.warning('Reference Information cant be empty');
                        return false;
                    }

                    if(this.add.reference.rows[i].men === "") {
                        toastr.warning('Reference Men cant be empty');
                        return false;
                    }

                    if(this.add.reference.rows[i].mh === "") {
                        toastr.warning('Reference MH cant be empty');
                        return false;
                    }
                }
            }

            if(this.add.part.rows.length > 0) {
                for(let i = 0; i < this.add.part.rows.length; i++) {
                    if(this.add.part.rows[i].part_number === "") {
                        toastr.warning('Part number cant be empty');
                        return false;
                    }

                    if(this.add.part.rows[i].type === "") {
                        toastr.warning('Part type cant be empty');
                        return false;
                    }

                    if(this.add.part.rows[i].qty === "") {
                        toastr.warning('Part QTY cant be empty');
                        return false;
                    }
                }
            }


            if(this.add.preppart.rows.length > 0) {
                for(let i = 0; i < this.add.preppart.rows.length; i++) {
                    if(this.add.preppart.rows[i].preparation === "") {
                        toastr.warning('Preparation part cant be empty');
                        return false;
                    }

                    if(this.add.preppart.rows[i].part_number === "") {
                        toastr.warning('Preparation part number cant be empty');
                        return false;
                    }

                    if(this.add.preppart.rows[i].type === "") {
                        toastr.warning('Preparation part type cant be empty');
                        return false;
                    }

                    if(this.add.preppart.rows[i].qty === "") {
                        toastr.warning('Preparation part QTY cant be empty');
                        return false;
                    }
                }
            }

            if(this.add.refpart.rows.length > 0) {
                for(let i = 0; i < this.add.refpart.rows.length; i++) {
                    if(this.add.refpart.rows[i].reference_information === "") {
                        toastr.warning('Reference part cant be empty');
                        return false;
                    }

                    if(this.add.refpart.rows[i].part_number === "") {
                        toastr.warning('Reference part number cant be empty');
                        return false;
                    }

                    if(this.add.refpart.rows[i].type === "") {
                        toastr.warning('Reference part type cant be empty');
                        return false;
                    }

                    if(this.add.refpart.rows[i].qty === "") {
                        toastr.warning('Reference part QTY cant be empty');
                        return false;
                    }
                }
            }

            return true;
        },

        handlerTextDescription: function(data) {
            let temp_data = data.substring(0, 50);
            let desc = temp_data.split("<br/>").join(" ");
            return desc;
        },

        handlerCheckDuplicate: function(index, data, field) {
            let search_term = this.add[data].rows[index][field];
            let filter =  this.add[data].rows.filter(d => d[field].toLowerCase() === search_term.toLowerCase());

            if(filter.length > 1) {
                toastr.warning("Data already exists");
                this.add[data].rows[index][field] = "";

                if(field === "part_number") {
                    this.add[data].rows[index]['type'] = "";
                }
            }
        },

        handlerCheckDuplicateMultiple: function(index, data, field1, field2) {
            let search_term = this.add[data].rows[index][field1];
            let search_term2 = this.add[data].rows[index][field2];
            let filter =  this.add[data].rows.filter(
                    d => d[field1].toLowerCase() === search_term.toLowerCase() && d[field2].toLowerCase() === search_term2.toLowerCase()
                );

            if(filter.length > 1) {
                toastr.warning("Data already exists");
                this.add[data].rows[index][field1] = "";
                this.add[data].rows[index][field2] = "";

                if(field2 == "access") {
                    this.add[data].rows[index]['men_remove'] = "";
                    this.add[data].rows[index]['men_install'] = "";
                    this.add[data].rows[index]['mh_remove'] = "";
                    this.add[data].rows[index]['mh_install'] = "";

                }else if(field2 == "part_number") {
                    this.add[data].rows[index]['type'] = "";
                }
            }
        },

        handelrSelectData: function(query, order) {
            if(this.m_select.classesid == 'edt-material-core-part' || this.m_select.classesid == 'edt-material-preparation' || this.m_select.classesid == 'edt-access-access') {

                this.m_select.loading = true;
                axios.post(`${this.m_select.api}`, {
                    aircraft_type: this.form_editor.aircraft_type,
                    mpd_number: this.form_editor.mpd_number,
                    id_revision: this.form_editor.id_revision,
                    keyword: query,
                })
                .then(res => {
                    this.m_select.items = res.data;
                    this.m_select.loading = false;
                })

            }else {
                if(query.length >= 1) {

                    this.m_select.loading = true;
                    axios.get(`${this.m_select.api}${query}`)
                    .then(res => {
                        this.m_select.items = res.data;
                        this.m_select.loading = false;
                    })

                }
            }
        },

        

        limitText: function (count) {
            return `and ${count} other orders`
        },

        handlerModalSelect: function(title, label, classesid, classesname, index, api, attr_hide, attr_show) {
            this.m_select.label = label;
            this.m_select.classesid = classesid;
            this.m_select.classesname = classesname;
            this.m_select.index = index;
            this.m_select.api = api;
            this.m_select.attr_hide = attr_hide;
            this.m_select.attr_show = attr_show;

            this.m_select.items = [];
            this.m_select.selected = "";

            document.getElementById("modal-select-title").innerHTML = title;
            document.getElementById("modal-select-label-title").innerHTML = title;

            if(this.m_select.classesid == 'edt-material-core-part') {
                this.m_select.items = this.editor.material.detail_material;
            }

            if(this.m_select.classesid == 'edt-material-preparation') {
                this.m_select.items = this.editor.preparation.detail_preparation;
            }

            

            $("#modal-select-data").show();
        },

        handlerAddSelect: function() {
            let elem_id = document.getElementsByClassName(this.m_select.classesid);
            let elem_name = document.getElementsByClassName(this.m_select.classesname);
            elem_id[this.m_select.index].value = this.m_select.selected[this.m_select.attr_hide];
            elem_name[this.m_select.index].value = this.m_select.selected[this.m_select.attr_show];
            elem_id[this.m_select.index].dispatchEvent(new Event('input'));
            elem_name[this.m_select.index].dispatchEvent(new Event('input'));

            if(this.m_select.classesid == 'edt-access-access') {
                this.handlerChangeAccess(this.m_select.index);
            }

            this.handlerClearSelect();

            $("#modal-select-data").hide();
        },

        handlerChangeAccess: function(index) {
            let edt_access_id = document.getElementsByClassName('edt-access-access')[this.m_select.index].value;
            let edt_access_mh = document.getElementsByClassName('edt-access-mhrs');
            let edt_access_mh_in = document.getElementsByClassName('edt-access-mhrs-install');
            let edt_access_men = document.getElementsByClassName('edt-access-men');
            let edt_access_men_in = document.getElementsByClassName('edt-access-men-install');

            let temp_mh = this.editor.access.access.filter(d => d.ID === edt_access_id);

            edt_access_mh[this.m_select.index].value = temp_mh[0].MH;
            edt_access_mh_in[this.m_select.index].value = temp_mh[0].MH_INSTALL;
            edt_access_men[this.m_select.index].value = temp_mh[0].MEN;
            edt_access_men_in[this.m_select.index].value = temp_mh[0].MEN_INSTALL;


            edt_access_mh[this.m_select.index].dispatchEvent(new Event('input'));
            edt_access_mh_in[this.m_select.index].dispatchEvent(new Event('input'));
            edt_access_men[this.m_select.index].dispatchEvent(new Event('input'));
            edt_access_men_in[this.m_select.index].dispatchEvent(new Event('input'));
        },

        handlerClearSelect: function() {
            this.m_select.label = "";
            this.m_select.classesid = "";
            this.m_select.classesname = "";
            this.m_select.index = "";
            this.m_select.api = "";
            this.m_select.attr_hide = "";
            this.m_select.attr_show = "";
        },

        handlerModalSelectAdd: function(title, attr, classes, index, api) {
            document.getElementById("modal-select-title-add").innerHTML = title;
            document.getElementById("modal-select-label-title-add").innerHTML = title;

            this.m_add.items = [];
            this.m_add.selected = "";

            this.m_add.api = api;
            this.m_add.classesid = classes;
            this.m_add.index = index;
            this.m_add.label = attr;
            $("#modal-select-data-add").show();
        },

        handlerAddSelectMPD: function() {
            let elem = document.getElementsByClassName(this.m_add.classesid);
            elem[this.m_add.index].value = this.m_add.selected[this.m_add.label];
            elem[this.m_add.index].dispatchEvent(new Event('input'));

            if(this.m_add.classesid === "edt-add-mpd-zone") {
                this.handlerCheckDuplicate(this.m_add.index, 'zone', 'zone')

            }else if(this.m_add.classesid === "edt-add-mpd-access") {
                
                this.add.access.rows[this.m_add.index].men_remove = this.m_add.selected['MEN']
                this.add.access.rows[this.m_add.index].men_install = this.m_add.selected['MEN_INSTALL']
                this.add.access.rows[this.m_add.index].mh_remove = this.m_add.selected['MH']
                this.add.access.rows[this.m_add.index].mh_install = this.m_add.selected['MH_INSTALL']

                this.handlerCheckDuplicateMultiple(this.m_add.index, 'access', 'zone', 'access');

            }else if(this.m_add.classesid === "edt-add-mpd-preparation" ){
                this.handlerCheckDuplicate(this.m_add.index, 'preparation', 'preparation');
                
            }else if(this.m_add.classesid === "edt-add-mpd-part") {
                this.add.part.rows[this.m_add.index].type = this.m_add.selected['TYPE'];
                this.handlerCheckDuplicate(this.m_add.index, 'part', 'part_number')

            }else if(this.m_add.classesid === "edt-add-mpd-prep-part") {
                this.add.preppart.rows[this.m_add.index].type = this.m_add.selected['TYPE'];
                this.handlerCheckDuplicateMultiple(this.m_add.index, 'preppart', 'preparation', 'part_number')
            }

            this.handlerClearSelectAdd();

            $("#modal-select-data-add").hide();
        },

        handlerClearSelectAdd: function() {
            this.m_add.label = "";
            this.m_add.classesid = "";
            this.m_add.index = "";
            this.m_add.api = "";
        },

        handelrSelectDataAdd: function(query, item) {
            if(this.m_add.classesid === "edt-add-mpd-access") {
                if(query.length >= 1) {
                    this.m_add.loading = true;
                    axios.post(`${this.m_add.api}`, {
                        keyword: query
                    })
                    .then(res => {
                        this.m_add.items = res.data;
                        this.m_add.loading = false;
                    })
                }
            }else {
                if(query.length >= 1) {
                    this.m_add.loading = true;
                    axios.get(`${this.m_add.api}${query}`)
                    .then(res => {
                        this.m_add.items = res.data;
                        this.m_add.loading = false;
                    })
                }
            }
        },

        handlerModalMasterData: function() {
            this.master.zone.is_show = false;
            this.master.access.is_show = false;
            this.master.preparation.is_show = false;
            this.master_type = "";

            $("#modal-master-data").show();
        },

        handlerOpenMaster: function() {
            this.master.zone.is_show = false;
            this.master.access.is_show = false;
            this.master.preparation.is_show = false;

            this.loading.isLoadingMaster = true;

            switch(this.master_type) {
                case 'master_zone':
                    this.handlerMasterZone().then(() => {
                        this.loading.isLoadingMaster = false;
                    });
                    break;
                case 'master_access':
                    this.handlerMasterAccess().then(() => {
                        this.loading.isLoadingMaster = false;
                    });
                    break;
                case 'master_preparation':
                    this.handlerMasterPreparation().then(() => {
                        this.loading.isLoadingMaster = false;
                    });
                    break;
                default:
                    this.loading.isLoadingMaster = false;
                    toastr.warning("Please select master type");
                    break;
            }
        },

        handlerMasterZone: function() {
            this.master.zone.is_show = true;
            this.loading.isLoadingMaster = true;
            return new Promise((resolve, reject) => {
                axios.post('/api/management/zone/get_zone', this.master.zone.serverParams)
                .then(res => {
                    this.master.zone.rows =  res.data.data;
                    this.master.zone.totalRows = res.data.total
                    this.loading.isLoadingMaster = false;
                    resolve();
                })
                .catch(e => {
                    console.log("Error: " + e);
                    toastr.error("Undefined error");
                    this.loading.isLoadingMaster = false;
                    resolve();
                })
            })
        },

        handlerMasterAccess: function() {
            this.master.access.is_show = true;
            this.loading.isLoadingMaster = true;
            return new Promise((resolve, reject) => {
                axios.post('/api/management/access/get_access', this.master.access.serverParams)
                .then(res => {
                    this.master.access.rows =  res.data.data;
                    this.master.access.totalRows = res.data.total
                    this.loading.isLoadingMaster = false;
                    resolve();
                })
                .catch(e => {
                    console.log("Error: " + e);
                    toastr.error("Undefined error");
                    this.loading.isLoadingMaster = false;
                    resolve();
                })
            })
        },

        handlerMasterPreparation: function() {
            this.master.preparation.is_show = true;
            this.loading.isLoadingMaster = true;
            return new Promise((resolve, reject) => {
                axios.post('/api/management/preparation/get_preparation', this.master.preparation.serverParams)
                .then(res => {
                    this.master.preparation.rows =  res.data.data;
                    this.master.preparation.totalRows = res.data.total
                    this.loading.isLoadingMaster = false;
                    resolve();
                })
                .catch(e => {
                    console.log("Error: " + e);
                    toastr.error("Undefined error");
                    this.loading.isLoadingMaster = false;
                    resolve();
                })
            })
        },

        // datatable master zone
        updateParamsMZone(newProps) {
            this.master.zone.serverParams = Object.assign({}, this.master.zone.serverParams, newProps);
        },
        
        onPageChangeMZone(params) {
            this.updateParamsMZone({page: params.currentPage});
            this.loadItemsMZone();
        },

        onPerPageChangeMZone(params) {
            this.master.zone.serverParams.page = 1;
            this.updateParamsMZone({perPage: params.currentPerPage});
            this.loadItemsMZone();
        },

        onSortChangeMZone(params) {
            this.updateParamsMZone({
                sort: {
                    type: params[0].type,
                    field: params[0].field,
                },
            });
            this.updateParamsMZone({page: 1});
            this.loadItemsMZone();
        },
        
        onColumnFilterMZone(params) {
            this.updateParamsMZone(params);
            this.updateParamsMZone({page: 1});
            this.loadItemsMZone();
        },

        onColumnSearchMZone(params) {
            this.updateParamsMZone(params);
            this.updateParamsMZone({page: 1});
            this.loadItemsMZone();
        },

        /**
         * load items is what brings back the rows from server
         */
        loadItemsMZone() {
            this.handleDatatableChangeMZone(this.master.zone.serverParams).then(()=> {
                this.loading.isLoadingMaster = false;
            });
            
        },

        handleDatatableChangeMZone: function(params) {
            this.loading.isLoadingMaster = true;

            return new Promise((resolve, reject) => {

                axios.post('/api/management/zone/get_zone', params)
                .then(res => {
                    this.master.zone.rows = res.data.data
                    this.master.zone.totalRows = res.data.total
                    this.loading.isLoadingMaster = false;
                    resolve();
                })
                .catch(e => {
                    console.log("Error: "+e)
                    this.loading.isLoadingMaster = false;
                    toastr.error("Undefined error");
                    resolve();
                })
            })
        },
        // /datatable master zone

        handlerModalMasterZone: function(status, index="") {
            document.getElementById('status-post-zone').innerHTML = status;
            if(index !== "") {
                this.master.zone.form.ID = this.master.zone.rows[index].ID;
                this.master.zone.form.ZONE = this.master.zone.rows[index].ZONE;
            }else {
                this.master.zone.form.ID = "";
                this.master.zone.form.ZONE = "";
            }

            $("#modal-master-zone").show();
        },

        handlerModalMasterAccess: function(status, index="") {
            document.getElementById('status-post-access').innerHTML = status;
            if(index !== "") {
                this.master.access.form.ID = this.master.access.rows[index].ID;
                this.master.access.form.ACCESS = this.master.access.rows[index].ACCESS;
                this.master.access.form.DESCRIPTION = this.master.access.rows[index].DESCRIPTION;
                this.master.access.form.MEN = this.master.access.rows[index].MEN;
                this.master.access.form.MH = this.master.access.rows[index].MH;
                this.master.access.form.MEN_INSTALL = this.master.access.rows[index].MEN_INSTALL;
                this.master.access.form.MH_INSTALL = this.master.access.rows[index].MH_INSTALL;
                this.master.access.form.AIRCRAFT = this.master.access.rows[index].AIRCRAFT;
            }else {
                this.master.access.form.ID = "";
                this.master.access.form.ACCESS = "";
                this.master.access.form.DESCRIPTION = "";
                this.master.access.form.MEN = "";
                this.master.access.form.MH = "";
                this.master.access.form.MEN_INSTALL = "";
                this.master.access.form.MH_INSTALL = "";
                this.master.access.form.AIRCRAFT = "";
            }

            $("#modal-master-access").show();
        },

        handlerModalMasterPreparation: function(status, index="") {
            document.getElementById('status-post-preparation').innerHTML = status;
            if(index !== "") {
                this.master.preparation.form.ID = this.master.preparation.rows[index].ID;
                this.master.preparation.form.PREPARATION = this.master.preparation.rows[index].PREPARATION;
            }else {
                this.master.preparation.form.ID = "";
                this.master.preparation.form.PREPARATION = "";
            }

            $("#modal-master-preparation").show();
        },

        validateMasterZone: function() {
            if(this.master.zone.form.ZONE == "") {
                toastr.warning("Zone field can't be empty");
                return false;
            }

            return true;
        },

        validateMasterPreparation: function() {
            if(this.master.preparation.form.PREPARATION == "") {
                toastr.warning("Preparation field can't be empty");
                return false;
            }

            return true;
        },


        validateMasterAccess: function() {
            if(this.master.access.form.ACCESS == "") {
                toastr.warning("Access field can't be empty");
                return false;
            }

            if(this.master.access.form.DESCRIPTION == "") {
                toastr.warning("Description field can't be empty");
                return false;
            }

            if(this.master.access.form.MEN == "") {
                toastr.warning("Men remove field can't be empty");
                return false;
            }

            if(this.master.access.form.MH == "") {
                toastr.warning("Mhrs remove field can't be empty");
                return false;
            }

            if(this.master.access.form.MEN_INSTALL == "") {
                toastr.warning("Men Install field can't be empty");
                return false;
            }

            if(this.master.access.form.MH_INSTALL == "") {
                toastr.warning("Mhrs Install field can't be empty");
                return false;
            }

            if(this.master.access.form.AIRCRAFT == "") {
                toastr.warning("Aircraft field can't be empty");
                return false;
            }

            return true;
        },

        handlerPostMasterZone: function() {
            if(!this.validateMasterZone()) return;

            this.handleButton('btn-save-master-zone', 'load').then(() => {
                axios.post('/api/management/zone/post_zone', this.master.zone.form)
                .then(res => {
                    if(res.data.success) {
                        toastr.success(res.data.message);

                        setTimeout(()=> {
                            this.hideModal('modal-master-zone');
                        }, 500)
                        this.handlerMasterZone().then(() => {
                            this.loading.isLoadingMaster = false;
                        });

                    }else {
                        toastr.error(res.data.message);
                    }

                    this.handleButton('btn-save-master-zone', 'stop');

                })
                .catch(e => {
                    console.log("Error: "+e)
                    this.handleButton('btn-save-master-zone', 'stop');
                    toastr.error("Undefined error");
                })
            })
        },

        handlerPostMasterAccess: function() {
            if(!this.validateMasterAccess()) return;

            this.handleButton('btn-save-master-access', 'load').then(() => {
                axios.post('/api/management/access/post_access', this.master.access.form)
                .then(res => {
                    if(res.data.success) {
                        toastr.success(res.data.message);

                        setTimeout(()=> {
                            this.hideModal('modal-master-access');
                        }, 500)
                        this.handlerMasterAccess().then(() => {
                            this.loading.isLoadingMaster = false;
                        });

                    }else {
                        toastr.error(res.data.message);
                    }

                    this.handleButton('btn-save-master-access', 'stop');

                })
                .catch(e => {
                    console.log("Error: "+e)
                    this.handleButton('btn-save-master-access', 'stop');
                    toastr.error("Undefined error");
                })
            })
        },

        handlerPostMasterPreparation: function() {
            if(!this.validateMasterPreparation()) return;

            this.handleButton('btn-save-master-preparation', 'load').then(() => {
                axios.post('/api/management/preparation/post_preparation', this.master.preparation.form)
                .then(res => {
                    if(res.data.success) {
                        toastr.success(res.data.message);

                        setTimeout(()=> {
                            this.hideModal('modal-master-preparation');
                        }, 500)
                        this.handlerMasterPreparation().then(() => {
                            this.loading.isLoadingMaster = false;
                        });

                    }else {
                        toastr.error(res.data.message);
                    }

                    this.handleButton('btn-save-master-preparation', 'stop');

                })
                .catch(e => {
                    console.log("Error: "+e)
                    this.handleButton('btn-save-master-preparation', 'stop');
                    toastr.error("Undefined error");
                })
            })
        },

        handlerRemoveMasterZone: function(id) {
            swal({
                title: "Remove Item",
                text: "Are you sure that you want remove this item?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    axios.get('/api/management/zone/remove_zone/' + id)
                    .then(res => {
                        if(res.data.message) {
                            toastr.success(res.data.message);
                            this.handlerMasterZone().then(() => {
                                this.loading.isLoadingMaster = false;
                            });
                        }else {
                            toastr.error(res.data.message);
                        }
                    })
                    .catch(e => {
                        console.log("Error: " + e);
                        toastr.error('Undefined error');
                    })
                } else {
                    toastr.info("Canceled");
                    return;
                }
            });
        },

        handlerRemoveMasterPreparation: function(id) {
            swal({
                title: "Remove Item",
                text: "Are you sure that you want remove this item?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    axios.get('/api/management/preparation/remove_preparation/' + id)
                    .then(res => {
                        if(res.data.message) {
                            toastr.success(res.data.message);
                            this.handlerMasterPreparation().then(() => {
                                this.loading.isLoadingMaster = false;
                            });
                        }else {
                            toastr.error(res.data.message);
                        }
                    })
                    .catch(e => {
                        console.log("Error: " + e);
                        toastr.error('Undefined error');
                    })
                } else {
                    toastr.info("Canceled");
                    return;
                }
            });
        },

        handlerRemoveMasterAccess: function(id) {
            swal({
                title: "Remove Item",
                text: "Are you sure that you want remove this item?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((value) => {
                if (value) {
                    axios.get('/api/management/access/remove_access/' + id)
                    .then(res => {
                        if(res.data.message) {
                            toastr.success(res.data.message);
                            this.handlerMasterAccess().then(() => {
                                this.loading.isLoadingMaster = false;
                            });
                        }else {
                            toastr.error(res.data.message);
                        }
                    })
                    .catch(e => {
                        console.log("Error: " + e);
                        toastr.error('Undefined error');
                    })
                } else {
                    toastr.info("Canceled");
                    return;
                }
            });
        },

        // datatable master access
        updateParamsMAccess(newProps) {
            this.master.access.serverParams = Object.assign({}, this.master.access.serverParams, newProps);
        },
        
        onPageChangeMAccess(params) {
            this.updateParamsMAccess({page: params.currentPage});
            this.loadItemsMAccess();
        },

        onPerPageChangeMAccess(params) {
            this.master.access.serverParams.page = 1;
            this.updateParamsMAccess({perPage: params.currentPerPage});
            this.loadItemsMAccess();
        },

        onSortChangeMAccess(params) {
            this.updateParamsMAccess({
                sort: {
                    type: params[0].type,
                    field: params[0].field,
                },
            });
            this.updateParamsMAccess({page: 1});
            this.loadItemsMAccess();
        },
        
        onColumnFilterMAccess(params) {
            this.updateParamsMAccess(params);
            this.updateParamsMAccess({page: 1});
            this.loadItemsMAccess();
        },

        onColumnSearchMAccess(params) {
            this.updateParamsMAccess(params);
            this.updateParamsMAccess({page: 1});
            this.loadItemsMAccess();
        },

        /**
         * load items is what brings back the rows from server
         */
        loadItemsMAccess() {
            this.handleDatatableChangeMAccess(this.master.access.serverParams).then(()=> {
                this.loading.isLoadingMaster = false;
            });
            
        },

        handleDatatableChangeMAccess: function(params) {
            this.loading.isLoadingMaster = true;

            return new Promise((resolve, reject) => {

                axios.post('/api/management/access/get_access', params)
                .then(res => {
                    this.master.access.rows = res.data.data
                    this.master.access.totalRows = res.data.total
                    this.loading.isLoadingMaster = false;
                    resolve();
                })
                .catch(e => {
                    console.log("Error: "+e)
                    this.loading.isLoadingMaster = false;
                    toastr.error("Undefined error");
                    resolve();
                })
            })
        },
        // /datatable master access

        // datatable master preparation
        updateParamsMPrep(newProps) {
            this.master.preparation.serverParams = Object.assign({}, this.master.preparation.serverParams, newProps);
        },
        
        onPageChangeMPrep(params) {
            this.updateParamsMPrep({page: params.currentPage});
            this.loadItemsMPrep();
        },

        onPerPageChangeMPrep(params) {
            this.master.preparation.serverParams.page = 1;
            this.updateParamsMPrep({perPage: params.currentPerPage});
            this.loadItemsMPrep();
        },

        onSortChangeMPrep(params) {
            this.updateParamsMZone({
                sort: {
                    type: params[0].type,
                    field: params[0].field,
                },
            });
            this.updateParamsMPrep({page: 1});
            this.loadItemsMPrep();
        },
        
        onColumnFilterMPrep(params) {
            this.updateParamsMPrep(params);
            this.updateParamsMPrep({page: 1});
            this.loadItemsMPrep();
        },

        onColumnSearchMPrep(params) {
            this.updateParamsMPrep(params);
            this.updateParamsMPrep({page: 1});
            this.loadItemsMPrep();
        },

        /**
         * load items is what brings back the rows from server
         */
        loadItemsMPrep() {
            this.handleDatatableChangeMPrep(this.master.preparation.serverParams).then(()=> {
                this.loading.isLoadingMaster = false;
            });
            
        },

        handleDatatableChangeMPrep: function(params) {
            this.loading.isLoadingMaster = true;

            return new Promise((resolve, reject) => {

                axios.post('/api/management/preparation/get_preparation', params)
                .then(res => {
                    this.master.preparation.rows = res.data.data
                    this.master.preparation.totalRows = res.data.total
                    this.loading.isLoadingMaster = false;
                    resolve();
                })
                .catch(e => {
                    console.log("Error: "+e)
                    this.loading.isLoadingMaster = false;
                    toastr.error("Undefined error");
                    resolve();
                })
            })
        },
        // /datatable master preparation

    }
}
</script>